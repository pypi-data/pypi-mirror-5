<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Simulation with Tracing &mdash; SimPy v2.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SimPy v2.0.1 documentation" href="../index.html" />
    <link rel="up" title="Using SimPy" href="../Using_SimPy.html" />
    <link rel="next" title="Simulation with Real Time Synchronization" href="SimRTManual.html" />
    <link rel="prev" title="SimPy’s Object Oriented API - New in Release 2.0" href="SimPyOO_API.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="SimRTManual.html" title="Simulation with Real Time Synchronization"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="SimPyOO_API.html" title="SimPy’s Object Oriented API - New in Release 2.0"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SimPy v2.0.1 documentation</a> &raquo;</li>
          <li><a href="../Using_SimPy.html" accesskey="U">Using SimPy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="simulation-with-tracing">
<h1><a class="toc-backref" href="#id1">Simulation with Tracing<a class="headerlink" href="#simulation-with-tracing" title="Permalink to this headline">¶</a></a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Authors:</th><td class="field-body"><ul class="first simple">
<li>Klaus Muller &lt;<a class="reference external" href="mailto:Muller&#37;&#52;&#48;users&#46;sourceforge&#46;net">Muller<span>&#64;</span>users<span>&#46;</span>sourceforge<span>&#46;</span>net</a>&gt;</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">SimPy release:</th><td class="field-body"><p class="first">2.0.1</p>
</td>
</tr>
<tr class="field"><th class="field-name">Web-site:</th><td class="field-body"><p class="first"><a class="reference external" href="http://simpy.sourceforge.net/">http://simpy.sourceforge.net/</a></p>
</td>
</tr>
<tr class="field"><th class="field-name">Python-Version:</th><td class="field-body"><p class="first">2.3 and later (not 3.0)</p>
</td>
</tr>
<tr class="field"><th class="field-name">Revision:</th><td class="field-body"><p class="first">$Revision: 297 $</p>
</td>
</tr>
<tr class="field"><th class="field-name">Date:</th><td class="field-body"><p class="first last">$Date: 2009-03-30 15:24:46 +0200 (Mo, 30 Mrz 2009) $</p>
</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#simulation-with-tracing" id="id1">Simulation with Tracing</a><ul>
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#tracing-simpy-programs" id="id3">Tracing <em>SimPy</em> programs</a></li>
<li><a class="reference internal" href="#trace-change-changing-the-tracing" id="id4"><strong>trace.change()</strong>: Changing the tracing</a></li>
<li><a class="reference internal" href="#treset-resetting-the-trace-to-default-values" id="id5"><strong>treset()</strong>: Resetting the trace to default values</a></li>
<li><a class="reference internal" href="#trace-tstart-trace-tstop-enabling-disabling-the-trace" id="id6"><strong>trace.tstart()</strong>, <strong>trace.tstop()</strong>: Enabling/disabling the trace</a></li>
<li><a class="reference internal" href="#trace-ttext-annotating-the-trace" id="id7"><strong>trace.ttext()</strong>: Annotating the trace</a></li>
<li><a class="reference internal" href="#nice-output-of-class-instances" id="id8">Nice output of class instances</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></a></h2>
<p>The tracing utility has been developed to give users insight into the
dynamics of the execution of SimPy simulation programs. It can help
developers with testing and users with explaining SimPy models to themselves
and others (e.g. for documentation or teaching purposes).</p>
</div>
<div class="section" id="tracing-simpy-programs">
<h2><a class="toc-backref" href="#id3">Tracing <em>SimPy</em> programs<a class="headerlink" href="#tracing-simpy-programs" title="Permalink to this headline">¶</a></a></h2>
<p>Tracing any <em>SimPy</em> program is as simple as replacing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SimPy.Simulation</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SimPy.SimulationTrace</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>This will give a complete trace of all the scheduling statements
executed during the program&#8217;s execution.</p>
<p>An even nicer way is to replace this import by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">SimPy.SimulationTrace</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">SimPy.Simulation</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>This gives a trace during the development and debugging. If one then
executes the program with
<em>python -O myprog.py</em>, tracing is switched off, and no run-time
overhead is incurred. (<em>__debug__</em> is a
global Python constant which is set to False by commandline options -O
and -OO.)</p>
<p>For the same reason, any user call to <em>trace</em> methods should be written
as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
        <span class="n">trace</span><span class="o">.</span><span class="n">ttext</span><span class="p">(</span><span class="s">&quot;This will only show during debugging&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is an example (bank02.py from the Bank Tutorial):</p>
<div class="highlight-python"><pre>from SimPy.SimulationTrace import * #   &lt;== changed for tracing
##from SimPy.Simulation import *

""" Simulate a single customer """
class Customer(Process):
""" Customer arrives, looks around and leaves """
   def __init__(self,name):
      Process.__init__(self)
      self.name = name

   def visit(self,timeInBank=0):
      print "%7.4f %s: Here I am"%(now(),self.name)
      yield hold,self,timeInBank
      print "%7.4f %s: I must leave"%(now(),self.name)

def model():
   initialize()
   c1=Customer(name="Klaus")
   activate(c1,c1.visit(timeInBank=10.0),delay=5.0)
   c2=Customer(name="Tony")
   activate(c2,c2.visit(timeInBank=8.0),delay=2.0)
   c3=Customer(name="Evelyn")
   activate(c3,c3.visit(timeInBank=20.0),delay=12.0)
   simulate(until=400.0)

model()</pre>
</div>
<p>This program produces the folowing output:</p>
<div class="highlight-python"><pre>0 activate &lt;Klaus&gt; at time: 5.0 prior: 0
0 activate &lt;Tony&gt; at time: 2.0 prior: 0
0 activate &lt;Evelyn&gt; at time: 12.0 prior: 0
2.0000 Tony: Here I am
2.0 hold &lt;Tony&gt; delay: 8.0
5.0000 Klaus: Here I am
5.0 hold &lt;Klaus&gt; delay: 10.0
10.0000 Tony: I must leave
10.0 &lt;Tony&gt; terminated
12.0000 Evelyn: Here I am
12.0 hold &lt;Evelyn&gt; delay: 20.0
15.0000 Klaus: I must leave
15.0 &lt;Klaus&gt; terminated
32.0000 Evelyn: I must leave
32.0 &lt;Evelyn&gt; terminated</pre>
</div>
<p>Another example:</p>
<div class="highlight-python"><pre>""" bank09.py: Simulate customers arriving
    at random, using a Source requesting service
    from several clerks but a single queue
    with a random servicetime
"""
from __future__ import generators
from SimPy.SimulationTrace  import *
from random import Random

class Source(Process):
    """ Source generates customers randomly"""
    def __init__(self,seed=333):
        Process.__init__(self)
        self.SEED = seed

    def generate(self,number,interval):
        rv = Random(self.SEED)
        for i in range(number):
            c = Customer(name = "Customer%02d"%(i,))
            activate(c,c.visit(timeInBank=12.0))
            t = rv.expovariate(1.0/interval)
            yield hold,self,t

class Customer(Process):
    """ Customer arrives, is served and leaves """
    def __init__(self,name):
        Process.__init__(self)
        self.name = name

    def visit(self,timeInBank=0):
        arrive=now()
        print "%7.4f %s: Here I am "%(now(),self.name)
        yield request,self,counter
        wait=now()-arrive
        print "%7.4f %s: Waited %6.3f"%(now(),self.name,wait)
        tib = counterRV.expovariate(1.0/timeInBank)
        yield hold,self,tib
        yield release,self,counter
        print "%7.4f %s: Finished"%(now(),self.name)

def model(counterseed=3939393):
    global counter,counterRV
    counter = Resource(name="Clerk",capacity = 2) #Lcapacity
    counterRV = Random(counterseed)
    initialize()
    sourceseed = 1133
    source = Source(seed = sourceseed)
    activate(source,source.generate(5,10.0),0.0)
    simulate(until=400.0)

model()

This produces:
  0 activate &lt;a_process&gt; at time: 0 prior: 0
0 activate &lt;Customer00&gt; at time: 0 prior: 0
0 hold &lt;a_process&gt; delay: 8.73140489458
 0.0000 Customer00: Here I am
0 request &lt;Customer00&gt; &lt;Clerk&gt;  priority: default
. . .waitQ: []
. . .activeQ: ['Customer00']
 0.0000 Customer00: Waited  0.000
0 hold &lt;Customer00&gt; delay: 8.90355092634
8.73140489458 activate &lt;Customer01&gt; at time: 8.73140489458 prior: 0
8.73140489458 hold &lt;a_process&gt; delay: 8.76709801376
 8.7314 Customer01: Here I am
8.73140489458 request &lt;Customer01&gt; &lt;Clerk&gt;  priority: default
. . .waitQ: []
. . .activeQ: ['Customer00', 'Customer01']
 8.7314 Customer01: Waited  0.000
8.73140489458 hold &lt;Customer01&gt; delay: 21.6676883425
8.90355092634 release &lt;Customer00&gt; &lt;Clerk&gt;
. . .waitQ: []
. . .activeQ: ['Customer01']
 8.9036 Customer00: Finished
8.90355092634 &lt;Customer00&gt; terminated
17.4985029083 activate &lt;Customer02&gt; at time: 17.4985029083 prior: 0

. . . . .</pre>
</div>
<p>And here is an example showing the trace output for compound yield statements:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">SimPy.SimulationTrace</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getServed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tank</span><span class="p">):</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">get</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">tank</span><span class="p">,</span><span class="mf">10</span><span class="p">),(</span><span class="n">hold</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">acquired</span><span class="p">(</span><span class="n">tank</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> got 10 </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">tank</span><span class="o">.</span><span class="n">unitName</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> reneged&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<span class="k">class</span> <span class="nc">Filler</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tank</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">hold</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="mf">1</span>
            <span class="k">yield</span> <span class="n">put</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">tank</span><span class="p">,</span><span class="mf">10</span>
<span class="n">initialize</span><span class="p">()</span>
<span class="n">tank</span><span class="o">=</span><span class="n">Level</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Tank&quot;</span><span class="p">,</span><span class="n">unitName</span><span class="o">=</span><span class="s">&quot;gallons&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span>
    <span class="n">c</span><span class="o">=</span><span class="n">Client</span><span class="p">(</span><span class="s">&quot;Client </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">i</span><span class="p">)</span>
    <span class="n">activate</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">getServed</span><span class="p">(</span><span class="n">tank</span><span class="p">))</span>
<span class="n">f</span><span class="o">=</span><span class="n">Filler</span><span class="p">(</span><span class="s">&quot;Tanker&quot;</span><span class="p">)</span>
<span class="n">activate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">tank</span><span class="p">))</span>
<span class="n">simulate</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mf">10</span><span class="p">)</span>
</pre></div>
</div>
<p>It produces this output:</p>
<div class="highlight-python"><pre>0 get &lt;Client 0&gt;to get: 10 gallons from &lt;Tank&gt;  priority: default
. . .getQ: ['Client 0']
. . .putQ: []
. . .in buffer: 0
|| RENEGE COMMAND:
||  hold &lt;Client 0&gt; delay: 1.5
0 get &lt;Client 1&gt;to get: 10 gallons from &lt;Tank&gt;  priority: default
. . .getQ: ['Client 0', 'Client 1']
. . .putQ: []
. . .in buffer: 0
|| RENEGE COMMAND:
||  hold &lt;Client 1&gt; delay: 1.5
0 hold &lt;Tanker&gt; delay: 1
0 hold &lt;RENEGE-hold for Client 0&gt; delay: 1.5
0 hold &lt;RENEGE-hold for Client 1&gt; delay: 1.5
1 put &lt;Tanker&gt; to put: 10 gallons into &lt;Tank&gt;  priority: default
. . .getQ: ['Client 1']
. . .putQ: []
. . .in buffer: 0
1 hold &lt;Tanker&gt; delay: 1
Client 0 got 10 gallons
1 &lt;Client 0&gt; terminated
1.5 &lt;RENEGE-hold for Client 1&gt; terminated
Client 1 reneged
1.5 &lt;Client 1&gt; terminated
2 put &lt;Tanker&gt; to put: 10 gallons into &lt;Tank&gt;  priority: default
. . .getQ: []
. . .putQ: []
. . .in buffer: 10
2 hold &lt;Tanker&gt; delay: 1
3 put &lt;Tanker&gt; to put: 10 gallons into &lt;Tank&gt;  priority: default
. . .getQ: []
. . .putQ: []
. . .in buffer: 20
3 &lt;Tanker&gt; terminated</pre>
</div>
<p>In this example, the Client entities are requesting 10 gallons from the <em>tank</em> (a Level object).
If they can&#8217;t get them within 1.5 time units, they renege (give up waiting).
The renege command parts of the compound statements (<em>hold,self,1.5</em>)are shown
in the trace output with a prefix of || to indicate that they are being executed
in parallel with the primary command part (<em>get,self,tank,10</em>). They are being
executed by behind-the-scenes processes (e.g. <em>RENEGE-hold for Client 0</em>).</p>
<p>The trace contains all calls of scheduling statements (<strong>yield . . .</strong>,
<strong>activate()</strong>, <strong>reactivate()</strong>, <strong>cancel()</strong> and also the termination
of processes (at completion of all their scheduling statements). For
<strong>yield request</strong> and <strong>yield release</strong> calls, it provides also the queue
status (waiting customers in <em>waitQ</em> and customers being served in <em>activeQ</em>.</p>
</div>
<div class="section" id="trace-change-changing-the-tracing">
<h2><a class="toc-backref" href="#id4"><strong>trace.change()</strong>: Changing the tracing<a class="headerlink" href="#trace-change-changing-the-tracing" title="Permalink to this headline">¶</a></a></h2>
<p><strong>trace</strong> is an instance of the <strong>Trace</strong> class defined in <em>SimulationTrace.py</em>.
This gets automatically initialized upon importing <em>SimulationTrace</em>..</p>
<p>The tracing can be changed at runtime by calling <strong>trace.tchange()</strong> with one or
more of the following named parameters:</p>
<blockquote>
<p><em>start</em>:</p>
<blockquote>
changes the tracing start time. Default is 0. Example: <strong>trace.tchange(start=222.2)</strong>
to start tracing at simulation time 222.2.</blockquote>
<p><em>end</em>  :</p>
<blockquote>
changes the tracing end time. Default is a very large number (hopefully past
any simulation endtime you will ever use).
Example: <strong>trace.tchange(end=33)</strong> to stop tracing at time 33.</blockquote>
<p><em>toTrace</em>:</p>
<blockquote>
changes the commands to be traced. Default is
<em>[&#8220;hold&#8221;,&#8221;activate&#8221;,&#8221;cancel&#8221;,&#8221;reactivate&#8221;,&#8221;passivate&#8221;,&#8221;request&#8221;,
&#8220;release&#8221;,&#8221;interrupt&#8221;,&#8221;waitevent&#8221;,&#8221;queueevent&#8221;,
&#8220;signal&#8221;,&#8221;waituntil&#8221;,&#8221;put&#8221;,&#8221;get&#8221;,&#8221;terminated&#8221;]</em>.
Value must be a list containing
one or more of those values in the default. Note: &#8220;terminated&#8221; causes
tracing of all process terminations.
Example: <strong>trace.tchange(toTrace=[&#8220;hold&#8221;,&#8221;activate&#8221;])</strong> traces only the
<em>yield hold</em> and <em>activate()</em> statements.</blockquote>
<p><em>outfile</em>:</p>
<blockquote>
redirects the trace out put to a file (default is <em>sys.stdout</em>). Value
must be a file object open for writing.
Example: <strong>trace.tchange(outfile=open(r&#8221;c:\python25\bank02trace.txt&#8221;,&#8221;w&#8221;))</strong></blockquote>
</blockquote>
<p>All these parameters can be combined.
Example: <strong>trace.tchange(start=45.0,toTrace=[&#8220;terminated&#8221;])</strong> will trace all
process terminations from time 45.0 till the end of the simulation.</p>
<p>The changes become effective at the time <strong>trace.tchange()</strong> is called. This
implies for example that, if the call <strong>trace.tchange(start=50)</strong> is made at time
100, it has no effect before <em>now()==100</em>.</p>
</div>
<div class="section" id="treset-resetting-the-trace-to-default-values">
<h2><a class="toc-backref" href="#id5"><strong>treset()</strong>: Resetting the trace to default values<a class="headerlink" href="#treset-resetting-the-trace-to-default-values" title="Permalink to this headline">¶</a></a></h2>
<p>The trace parameters can be reset to their default values by calling <strong>trace.treset()</strong>.</p>
</div>
<div class="section" id="trace-tstart-trace-tstop-enabling-disabling-the-trace">
<h2><a class="toc-backref" href="#id6"><strong>trace.tstart()</strong>, <strong>trace.tstop()</strong>: Enabling/disabling the trace<a class="headerlink" href="#trace-tstart-trace-tstop-enabling-disabling-the-trace" title="Permalink to this headline">¶</a></a></h2>
<p>Calling <strong>trace.tstart()</strong> enables the tracing, and <strong>trace.tstop()</strong>
disables it. Neither call changes any tracing parameters.</p>
</div>
<div class="section" id="trace-ttext-annotating-the-trace">
<h2><a class="toc-backref" href="#id7"><strong>trace.ttext()</strong>: Annotating the trace<a class="headerlink" href="#trace-ttext-annotating-the-trace" title="Permalink to this headline">¶</a></a></h2>
<p>The event-by-event trace output is already very useful in showing the sequence
in which SimPy&#8217;s quasi-parallel processes are executed.</p>
<p>For documentation, publishing or teaching purposes, it is even more useful
if the trace output can be intermingled with output which not only
shows the command executed, but also contextual information such as
the values of state variables. If one outputs the reason <em>why</em> a specific
scheduling command is executed, the trace can give a natural language description
of the simulation scenario.</p>
<p>For such in-line annotation, the <strong>trace.ttext(&lt;string&gt;)</strong> method is
available. It provides a string which is output together with the trace of
the next scheduling statement. This string is valid <em>only</em> for the scheduling
statement following it.</p>
<p>Example:</p>
<div class="highlight-python"><pre>class Bus(Process):
    def __init__(self,name):
        Process.__init__(self,name)

    def operate(self,repairduration=0):
        tripleft = 1000
        while tripleft &gt; 0:
            trace.ttext("Try to go for %s"%tripleft)
            yield hold,self,tripleft
            if self.interrupted():
                tripleft=self.interruptLeft
                self.interruptReset()
                trace.ttext("Start repair taking %s time units"%repairduration)
                yield hold,self,repairduration
            else:
                break # no breakdown, ergo bus arrived
        trace.ttext("&lt;%s&gt; has arrived"%self.name)

class Breakdown(Process):
    def __init__(self,myBus):
        Process.__init__(self,name="Breakdown "+myBus.name)
        self.bus=myBus

    def breakBus(self,interval):

        while True:
            trace.ttext("Breakdown process waiting for %s"%interval)
            yield hold,self,interval
            if self.bus.terminated(): break
            trace.ttext("Breakdown of %s"%self.bus.name)
            self.interrupt(self.bus)

print"\n\n+++test_interrupt"
initialize()
b=Bus("Bus 1")
trace.ttext("Start %s"%b.name)
activate(b,b.operate(repairduration=20))
br=Breakdown(b)
trace.ttext("Start the Breakdown process for %s"%b.name)
activate(br,br.breakBus(200))
trace.start=100
print simulate(until=4000)

This produces:

0 activate &lt;Bus 1&gt; at time: 0 prior: 0
---- Start Bus 1
0 activate &lt;Breakdown Bus 1&gt; at time: 0 prior: 0
---- Start the Breakdown process for Bus 1
200 reactivate &lt;Bus 1&gt; time: 200 prior: 0
200 interrupt by: &lt;Breakdown Bus 1&gt; of: &lt;Bus 1&gt;
---- Breakdown of Bus 1
200 hold &lt;Breakdown Bus 1&gt; delay: 200
---- Breakdown process waiting for 200
200 hold &lt;Bus 1&gt; delay: 20
---- Start repair taking 20 time units
220 hold &lt;Bus 1&gt; delay: 800
---- Try to go for 800
400 reactivate &lt;Bus 1&gt; time: 400 prior: 0
400 interrupt by: &lt;Breakdown Bus 1&gt; of: &lt;Bus 1&gt;
---- Breakdown of Bus 1
400 hold &lt;Breakdown Bus 1&gt; delay: 200
---- Breakdown process waiting for 200
400 hold &lt;Bus 1&gt; delay: 20
---- Start repair taking 20 time units
420 hold &lt;Bus 1&gt; delay: 620

 . . . . .</pre>
</div>
<p>The line starting with &#8220;&#8212;-&#8221; is the comment related to the command traced
in the preceding output line.</p>
</div>
<div class="section" id="nice-output-of-class-instances">
<h2><a class="toc-backref" href="#id8">Nice output of class instances<a class="headerlink" href="#nice-output-of-class-instances" title="Permalink to this headline">¶</a></a></h2>
<p>After the import of <em>SimPy.SimulationTrace</em>, all instances of classes
<em>Process</em> and <em>Resource</em> (and all their subclasses) have a nice string
representation like so:</p>
<div class="highlight-python"><pre>   &gt;&gt;&gt; class Bus(Process):
...         def __init__(self,id):
...                 Process.__init__(self,name=id)
...                 self.typ="Bus"
...
&gt;&gt;&gt; b=Bus("Line 15")
&gt;&gt;&gt; b
&lt;Instance of Bus, id 21860960:
     .name=Line 15
     .typ=Bus
&gt;
&gt;&gt;&gt;</pre>
</div>
<p>This can be handy in statements like <strong>trace.ttext(&#8220;Status of %s&#8221;%b)</strong>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/sm_SimPy_Logo.png" alt="Logo"/>
            </a></p>
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Simulation with Tracing</a><ul>
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#tracing-simpy-programs">Tracing <em>SimPy</em> programs</a></li>
<li><a class="reference external" href="#trace-change-changing-the-tracing"><strong>trace.change()</strong>: Changing the tracing</a></li>
<li><a class="reference external" href="#treset-resetting-the-trace-to-default-values"><strong>treset()</strong>: Resetting the trace to default values</a></li>
<li><a class="reference external" href="#trace-tstart-trace-tstop-enabling-disabling-the-trace"><strong>trace.tstart()</strong>, <strong>trace.tstop()</strong>: Enabling/disabling the trace</a></li>
<li><a class="reference external" href="#trace-ttext-annotating-the-trace"><strong>trace.ttext()</strong>: Annotating the trace</a></li>
<li><a class="reference external" href="#nice-output-of-class-instances">Nice output of class instances</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="SimPyOO_API.html"
                                  title="previous chapter">SimPy&#8217;s Object Oriented API - <strong>New in Release 2.0</strong></a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="SimRTManual.html"
                                  title="next chapter">Simulation with Real Time Synchronization</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/Manuals/Tracing.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="SimRTManual.html" title="Simulation with Real Time Synchronization"
             >next</a> |</li>
        <li class="right" >
          <a href="SimPyOO_API.html" title="SimPy’s Object Oriented API - New in Release 2.0"
             >previous</a> |</li>
        <li><a href="../index.html">SimPy v2.0.1 documentation</a> &raquo;</li>
          <li><a href="../Using_SimPy.html" >Using SimPy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, 2009; Klaus Muller, Tony Vignaux.
      Last updated on Apr 06, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>
  </body>
</html>