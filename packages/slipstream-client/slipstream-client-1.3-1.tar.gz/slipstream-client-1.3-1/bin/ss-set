#!/usr/bin/env python

from optparse import OptionParser

from com.sixsq.slipstream.CommandBase import CommandBase
from com.sixsq.slipstream.Client import Client   
from com.sixsq.slipstream.ConfigHolder import ConfigHolder

class MainProgram(CommandBase):
    '''A command-line program to set key/value pairs to info sys restlet.'''
    
    def __init__(self, argv=None):
        self.key = None
        self.value = None
        super(MainProgram,self).__init__(argv)

    def parse(self):
        usage = '''%prog [options] <key> [<value>]

<key>            Key from which to retrieve the value
<value>          Value to be set.  This parameter is mandatory, unless the
                 --decrement option is uses, in which case this parameter is
                 ignores'''

        self.addIgnoreAbortOption()

        self.options, self.args = self.parser.parse_args()

        if len(self.args) != 2:
                self.usageExit('Error, two argument must be specified')

        self.key = self.args[0]
        self.value = self.args[1]

    def doWork(self):
        configHolder = ConfigHolder(self.options)
        client = Client(configHolder)
        value = client.setRuntimeParameter(self.key, self.value)

main = MainProgram

##############################################################################
# Executing this module from the command line
##############################################################################

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print '\n\nExecution interrupted by the user... goodbye!'
