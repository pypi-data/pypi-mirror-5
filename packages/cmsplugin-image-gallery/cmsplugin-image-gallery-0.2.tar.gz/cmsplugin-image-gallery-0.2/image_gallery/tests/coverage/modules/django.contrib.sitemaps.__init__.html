<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <title>Test coverage report: django.contrib.sitemaps</title>
    <style type="text/css" media="screen">
      a
      {
        color: #3d707a;
      }
      
      a:hover, a:active
      {
        color: #bf7d18;
      }
    
      body 
      {
        font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
        font-size: 13px;
      }
      
      .nav 
      {
        font-size: 12px;
        margin-left: 50px;
      }

      .ignored
      {
        color: #707070;
      }

      .executed 
      {
        color: #3d9900;
      }

      .missed 
      {
        color: red;
        font-weight: bold;
      }

      .excluded 
      {
        color: #6090f0;
        font-weight: lighter;
      }
    
      #content-header 
      {
        font-size: 12px;
        padding: 18px 0 18px 50px;
      }

      #content-header h1 
      {
        font-size: 16px;
        margin: 10px 0 0 0;
        color: #909090;
      }
      
      #module-name
      {
        color: #583707;
      }
    
      #content-header p
      {
        font-size: 13px;
        margin: 0;
        color: #909090;
      }

      #content-header .normal 
      {
        color: #609030;
      }

      #content-header .warning 
      {
        color: #d0a000;
      }

      #content-header .critical 
      {
        color: red;
      }
      
      #source-listing 
      {
        margin-bottom: 24px;
      }

      #source-listing ol 
      {
        padding: 0 0 0 50px;
        width: 90%;
        font-family: monospace;
        list-style-position: outside;
      }

      #source-listing ol li 
      {
        line-height: 18px;
        font-size: small;
      }
        
      #source-listing ol code 
      {
        padding:  0 .001em 0 0; /* Firefox doesn't render empty li's properly */
        font-size: medium;
        white-space: pre;
      }
   </style>
  </head>

  <body>

<div class="nav">
  <a href="django.contrib.sessions.models.html">django.contrib.sessions.models</a> &lt;&lt;
  <a href="../index.html">index</a>
  &gt;&gt; <a href="django.contrib.sitemaps.management.commands.ping_google.html">django.contrib.sitemaps.management.commands.ping_google</a>
</div>

<div id="content-header">
  <h1>
    <span id="module-name">django.contrib.sitemaps</span>:
    80 total statements,
    <span class="critical">0.0% covered</span>
  </h1>
  <p>Generated: Wed 2013-03-13 10:33 CET</p>
  <p>Source file: /media/Envs/Envs/filer-gallery/lib/python2.7/site-packages/django/contrib/sitemaps/__init__.py</p>
  <p>
    Stats:
    <span class="executed">0 executed</span>,
    <span class="missed">75 missed</span>,
    <span class="excluded">5 excluded</span>,
    <span class="ignored">40 ignored</span> 
  </p> 
</div>

<div id="source-listing">
  <ol>
    <li class="excluded"><code>from django.contrib.sites.models import Site</code></li>
<li class="excluded"><code>from django.core import urlresolvers, paginator</code></li>
<li class="excluded"><code>from django.core.exceptions import ImproperlyConfigured</code></li>
<li class="excluded"><code>import urllib</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>PING_URL = "http://www.google.com/webmasters/tools/ping"</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>class SitemapNotFound(Exception):</code></li>
<li class="missed"><code>    pass</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>def ping_google(sitemap_url=None, ping_url=PING_URL):</code></li>
<li class="ignored"><code>    """</code></li>
<li class="ignored"><code>    Alerts Google that the sitemap for the current site has been updated.</code></li>
<li class="ignored"><code>    If sitemap_url is provided, it should be an absolute path to the sitemap</code></li>
<li class="ignored"><code>    for this site -- e.g., '/sitemap.xml'. If sitemap_url is not provided, this</code></li>
<li class="ignored"><code>    function will attempt to deduce it by using urlresolvers.reverse().</code></li>
<li class="ignored"><code>    """</code></li>
<li class="missed"><code>    if sitemap_url is None:</code></li>
<li class="missed"><code>        try:</code></li>
<li class="ignored"><code>            # First, try to get the "index" sitemap URL.</code></li>
<li class="missed"><code>            sitemap_url = urlresolvers.reverse('django.contrib.sitemaps.views.index')</code></li>
<li class="missed"><code>        except urlresolvers.NoReverseMatch:</code></li>
<li class="missed"><code>            try:</code></li>
<li class="ignored"><code>                # Next, try for the "global" sitemap URL.</code></li>
<li class="missed"><code>                sitemap_url = urlresolvers.reverse('django.contrib.sitemaps.views.sitemap')</code></li>
<li class="missed"><code>            except urlresolvers.NoReverseMatch:</code></li>
<li class="missed"><code>                pass</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    if sitemap_url is None:</code></li>
<li class="missed"><code>        raise SitemapNotFound("You didn't provide a sitemap_url, and the sitemap URL couldn't be auto-detected.")</code></li>
<li class="ignored"><code></code></li>
<li class="excluded"><code>    from django.contrib.sites.models import Site</code></li>
<li class="missed"><code>    current_site = Site.objects.get_current()</code></li>
<li class="missed"><code>    url = "http://%s%s" % (current_site.domain, sitemap_url)</code></li>
<li class="missed"><code>    params = urllib.urlencode({'sitemap':url})</code></li>
<li class="missed"><code>    urllib.urlopen("%s?%s" % (ping_url, params))</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>class Sitemap(object):</code></li>
<li class="ignored"><code>    # This limit is defined by Google. See the index documentation at</code></li>
<li class="ignored"><code>    # http://sitemaps.org/protocol.php#index.</code></li>
<li class="missed"><code>    limit = 50000</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code>    # If protocol is None, the URLs in the sitemap will use the protocol</code></li>
<li class="ignored"><code>    # with which the sitemap was requested.</code></li>
<li class="missed"><code>    protocol = None</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def __get(self, name, obj, default=None):</code></li>
<li class="missed"><code>        try:</code></li>
<li class="missed"><code>            attr = getattr(self, name)</code></li>
<li class="missed"><code>        except AttributeError:</code></li>
<li class="missed"><code>            return default</code></li>
<li class="missed"><code>        if callable(attr):</code></li>
<li class="missed"><code>            return attr(obj)</code></li>
<li class="missed"><code>        return attr</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def items(self):</code></li>
<li class="missed"><code>        return []</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def location(self, obj):</code></li>
<li class="missed"><code>        return obj.get_absolute_url()</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def _get_paginator(self):</code></li>
<li class="missed"><code>        return paginator.Paginator(self.items(), self.limit)</code></li>
<li class="missed"><code>    paginator = property(_get_paginator)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def get_urls(self, page=1, site=None, protocol=None):</code></li>
<li class="ignored"><code>        # Determine protocol</code></li>
<li class="missed"><code>        if self.protocol is not None:</code></li>
<li class="missed"><code>            protocol = self.protocol</code></li>
<li class="missed"><code>        if protocol is None:</code></li>
<li class="missed"><code>            protocol = 'http'</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code>        # Determine domain</code></li>
<li class="missed"><code>        if site is None:</code></li>
<li class="missed"><code>            if Site._meta.installed:</code></li>
<li class="missed"><code>                try:</code></li>
<li class="missed"><code>                    site = Site.objects.get_current()</code></li>
<li class="missed"><code>                except Site.DoesNotExist:</code></li>
<li class="missed"><code>                    pass</code></li>
<li class="missed"><code>            if site is None:</code></li>
<li class="missed"><code>                raise ImproperlyConfigured("To use sitemaps, either enable the sites framework or pass a Site/RequestSite object in your view.")</code></li>
<li class="missed"><code>        domain = site.domain</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>        urls = []</code></li>
<li class="missed"><code>        for item in self.paginator.page(page).object_list:</code></li>
<li class="missed"><code>            loc = "%s://%s%s" % (protocol, domain, self.__get('location', item))</code></li>
<li class="missed"><code>            priority = self.__get('priority', item, None)</code></li>
<li class="missed"><code>            url_info = {</code></li>
<li class="ignored"><code>                'item':       item,</code></li>
<li class="ignored"><code>                'location':   loc,</code></li>
<li class="ignored"><code>                'lastmod':    self.__get('lastmod', item, None),</code></li>
<li class="ignored"><code>                'changefreq': self.__get('changefreq', item, None),</code></li>
<li class="ignored"><code>                'priority':   str(priority is not None and priority or ''),</code></li>
<li class="ignored"><code>            }</code></li>
<li class="missed"><code>            urls.append(url_info)</code></li>
<li class="missed"><code>        return urls</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>class FlatPageSitemap(Sitemap):</code></li>
<li class="missed"><code>    def items(self):</code></li>
<li class="missed"><code>        current_site = Site.objects.get_current()</code></li>
<li class="missed"><code>        return current_site.flatpage_set.filter(registration_required=False)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>class GenericSitemap(Sitemap):</code></li>
<li class="missed"><code>    priority = None</code></li>
<li class="missed"><code>    changefreq = None</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def __init__(self, info_dict, priority=None, changefreq=None):</code></li>
<li class="missed"><code>        self.queryset = info_dict['queryset']</code></li>
<li class="missed"><code>        self.date_field = info_dict.get('date_field', None)</code></li>
<li class="missed"><code>        self.priority = priority</code></li>
<li class="missed"><code>        self.changefreq = changefreq</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def items(self):</code></li>
<li class="ignored"><code>        # Make sure to return a clone; we don't want premature evaluation.</code></li>
<li class="missed"><code>        return self.queryset.filter()</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    def lastmod(self, item):</code></li>
<li class="missed"><code>        if self.date_field is not None:</code></li>
<li class="missed"><code>            return getattr(item, self.date_field)</code></li>
<li class="missed"><code>        return None</code></li>
  </ol>
</div>

<div class="nav">
  <a href="django.contrib.sessions.models.html">django.contrib.sessions.models</a> &lt;&lt;
  <a href="../index.html">index</a>
  &gt;&gt; <a href="django.contrib.sitemaps.management.commands.ping_google.html">django.contrib.sitemaps.management.commands.ping_google</a>
</div>

  </body>
</html>

