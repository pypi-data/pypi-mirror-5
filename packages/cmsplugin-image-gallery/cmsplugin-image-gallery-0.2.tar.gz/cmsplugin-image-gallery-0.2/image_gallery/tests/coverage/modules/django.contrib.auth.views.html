<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <title>Test coverage report: django.contrib.auth.views</title>
    <style type="text/css" media="screen">
      a
      {
        color: #3d707a;
      }
      
      a:hover, a:active
      {
        color: #bf7d18;
      }
    
      body 
      {
        font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
        font-size: 13px;
      }
      
      .nav 
      {
        font-size: 12px;
        margin-left: 50px;
      }

      .ignored
      {
        color: #707070;
      }

      .executed 
      {
        color: #3d9900;
      }

      .missed 
      {
        color: red;
        font-weight: bold;
      }

      .excluded 
      {
        color: #6090f0;
        font-weight: lighter;
      }
    
      #content-header 
      {
        font-size: 12px;
        padding: 18px 0 18px 50px;
      }

      #content-header h1 
      {
        font-size: 16px;
        margin: 10px 0 0 0;
        color: #909090;
      }
      
      #module-name
      {
        color: #583707;
      }
    
      #content-header p
      {
        font-size: 13px;
        margin: 0;
        color: #909090;
      }

      #content-header .normal 
      {
        color: #609030;
      }

      #content-header .warning 
      {
        color: #d0a000;
      }

      #content-header .critical 
      {
        color: red;
      }
      
      #source-listing 
      {
        margin-bottom: 24px;
      }

      #source-listing ol 
      {
        padding: 0 0 0 50px;
        width: 90%;
        font-family: monospace;
        list-style-position: outside;
      }

      #source-listing ol li 
      {
        line-height: 18px;
        font-size: small;
      }
        
      #source-listing ol code 
      {
        padding:  0 .001em 0 0; /* Firefox doesn't render empty li's properly */
        font-size: medium;
        white-space: pre;
      }
   </style>
  </head>

  <body>

<div class="nav">
  <a href="django.contrib.auth.tokens.html">django.contrib.auth.tokens</a> &lt;&lt;
  <a href="../index.html">index</a>
  &gt;&gt; <a href="django.contrib.contenttypes.generic.html">django.contrib.contenttypes.generic</a>
</div>

<div id="content-header">
  <h1>
    <span id="module-name">django.contrib.auth.views</span>:
    137 total statements,
    <span class="critical">0.0% covered</span>
  </h1>
  <p>Generated: Wed 2013-03-13 10:33 CET</p>
  <p>Source file: /media/Envs/Envs/filer-gallery/lib/python2.7/site-packages/django/contrib/auth/views.py</p>
  <p>
    Stats:
    <span class="executed">0 executed</span>,
    <span class="missed">121 missed</span>,
    <span class="excluded">16 excluded</span>,
    <span class="ignored">124 ignored</span> 
  </p> 
</div>

<div id="source-listing">
  <ol>
    <li class="excluded"><code>import urlparse</code></li>
<li class="ignored"><code></code></li>
<li class="excluded"><code>from django.conf import settings</code></li>
<li class="excluded"><code>from django.core.urlresolvers import reverse</code></li>
<li class="excluded"><code>from django.http import HttpResponseRedirect, QueryDict</code></li>
<li class="excluded"><code>from django.template.response import TemplateResponse</code></li>
<li class="excluded"><code>from django.utils.http import base36_to_int, is_safe_url</code></li>
<li class="excluded"><code>from django.utils.translation import ugettext as _</code></li>
<li class="excluded"><code>from django.views.decorators.debug import sensitive_post_parameters</code></li>
<li class="excluded"><code>from django.views.decorators.cache import never_cache</code></li>
<li class="excluded"><code>from django.views.decorators.csrf import csrf_protect</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code># Avoid shadowing the login() and logout() views below.</code></li>
<li class="excluded"><code>from django.contrib.auth import REDIRECT_FIELD_NAME, login as auth_login, logout as auth_logout</code></li>
<li class="excluded"><code>from django.contrib.auth.decorators import login_required</code></li>
<li class="excluded"><code>from django.contrib.auth.forms import AuthenticationForm, PasswordResetForm, SetPasswordForm, PasswordChangeForm</code></li>
<li class="excluded"><code>from django.contrib.auth.models import User</code></li>
<li class="excluded"><code>from django.contrib.auth.tokens import default_token_generator</code></li>
<li class="excluded"><code>from django.contrib.sites.models import get_current_site</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>@sensitive_post_parameters()</code></li>
<li class="missed"><code>@csrf_protect</code></li>
<li class="missed"><code>@never_cache</code></li>
<li class="missed"><code>def login(request, template_name='registration/login.html',</code></li>
<li class="ignored"><code>          redirect_field_name=REDIRECT_FIELD_NAME,</code></li>
<li class="ignored"><code>          authentication_form=AuthenticationForm,</code></li>
<li class="ignored"><code>          current_app=None, extra_context=None):</code></li>
<li class="ignored"><code>    """</code></li>
<li class="ignored"><code>    Displays the login form and handles the login action.</code></li>
<li class="ignored"><code>    """</code></li>
<li class="missed"><code>    redirect_to = request.REQUEST.get(redirect_field_name, '')</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    if request.method == "POST":</code></li>
<li class="missed"><code>        form = authentication_form(data=request.POST)</code></li>
<li class="missed"><code>        if form.is_valid():</code></li>
<li class="ignored"><code>            # Ensure the user-originating redirection url is safe.</code></li>
<li class="missed"><code>            if not is_safe_url(url=redirect_to, host=request.get_host()):</code></li>
<li class="missed"><code>                redirect_to = settings.LOGIN_REDIRECT_URL</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code>            # Okay, security check complete. Log the user in.</code></li>
<li class="missed"><code>            auth_login(request, form.get_user())</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>            if request.session.test_cookie_worked():</code></li>
<li class="missed"><code>                request.session.delete_test_cookie()</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>            return HttpResponseRedirect(redirect_to)</code></li>
<li class="ignored"><code>    else:</code></li>
<li class="missed"><code>        form = authentication_form(request)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    request.session.set_test_cookie()</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    current_site = get_current_site(request)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    context = {</code></li>
<li class="ignored"><code>        'form': form,</code></li>
<li class="ignored"><code>        redirect_field_name: redirect_to,</code></li>
<li class="ignored"><code>        'site': current_site,</code></li>
<li class="ignored"><code>        'site_name': current_site.name,</code></li>
<li class="ignored"><code>    }</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>def logout(request, next_page=None,</code></li>
<li class="ignored"><code>           template_name='registration/logged_out.html',</code></li>
<li class="ignored"><code>           redirect_field_name=REDIRECT_FIELD_NAME,</code></li>
<li class="ignored"><code>           current_app=None, extra_context=None):</code></li>
<li class="ignored"><code>    """</code></li>
<li class="ignored"><code>    Logs out the user and displays 'You are logged out' message.</code></li>
<li class="ignored"><code>    """</code></li>
<li class="missed"><code>    auth_logout(request)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    if redirect_field_name in request.REQUEST:</code></li>
<li class="missed"><code>        next_page = request.REQUEST[redirect_field_name]</code></li>
<li class="ignored"><code>        # Security check -- don't allow redirection to a different host.</code></li>
<li class="missed"><code>        if not is_safe_url(url=next_page, host=request.get_host()):</code></li>
<li class="missed"><code>            next_page = request.path</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    if next_page:</code></li>
<li class="ignored"><code>        # Redirect to this page until the session has been cleared.</code></li>
<li class="missed"><code>        return HttpResponseRedirect(next_page)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    current_site = get_current_site(request)</code></li>
<li class="missed"><code>    context = {</code></li>
<li class="ignored"><code>        'site': current_site,</code></li>
<li class="ignored"><code>        'site_name': current_site.name,</code></li>
<li class="ignored"><code>        'title': _('Logged out')</code></li>
<li class="ignored"><code>    }</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>        current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>def logout_then_login(request, login_url=None, current_app=None, extra_context=None):</code></li>
<li class="ignored"><code>    """</code></li>
<li class="ignored"><code>    Logs out the user if he is logged in. Then redirects to the log-in page.</code></li>
<li class="ignored"><code>    """</code></li>
<li class="missed"><code>    if not login_url:</code></li>
<li class="missed"><code>        login_url = settings.LOGIN_URL</code></li>
<li class="missed"><code>    return logout(request, login_url, current_app=current_app, extra_context=extra_context)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>def redirect_to_login(next, login_url=None,</code></li>
<li class="ignored"><code>                      redirect_field_name=REDIRECT_FIELD_NAME):</code></li>
<li class="ignored"><code>    """</code></li>
<li class="ignored"><code>    Redirects the user to the login page, passing the given 'next' page</code></li>
<li class="ignored"><code>    """</code></li>
<li class="missed"><code>    if not login_url:</code></li>
<li class="missed"><code>        login_url = settings.LOGIN_URL</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    login_url_parts = list(urlparse.urlparse(login_url))</code></li>
<li class="missed"><code>    if redirect_field_name:</code></li>
<li class="missed"><code>        querystring = QueryDict(login_url_parts[4], mutable=True)</code></li>
<li class="missed"><code>        querystring[redirect_field_name] = next</code></li>
<li class="missed"><code>        login_url_parts[4] = querystring.urlencode(safe='/')</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    return HttpResponseRedirect(urlparse.urlunparse(login_url_parts))</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code># 4 views for password reset:</code></li>
<li class="ignored"><code># - password_reset sends the mail</code></li>
<li class="ignored"><code># - password_reset_done shows a success message for the above</code></li>
<li class="ignored"><code># - password_reset_confirm checks the link the user clicked and</code></li>
<li class="ignored"><code>#   prompts for a new password</code></li>
<li class="ignored"><code># - password_reset_complete shows a success message for the above</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>@csrf_protect</code></li>
<li class="missed"><code>def password_reset(request, is_admin_site=False,</code></li>
<li class="ignored"><code>                   template_name='registration/password_reset_form.html',</code></li>
<li class="ignored"><code>                   email_template_name='registration/password_reset_email.html',</code></li>
<li class="ignored"><code>                   subject_template_name='registration/password_reset_subject.txt',</code></li>
<li class="ignored"><code>                   password_reset_form=PasswordResetForm,</code></li>
<li class="ignored"><code>                   token_generator=default_token_generator,</code></li>
<li class="ignored"><code>                   post_reset_redirect=None,</code></li>
<li class="ignored"><code>                   from_email=None,</code></li>
<li class="ignored"><code>                   current_app=None,</code></li>
<li class="ignored"><code>                   extra_context=None):</code></li>
<li class="missed"><code>    if post_reset_redirect is None:</code></li>
<li class="missed"><code>        post_reset_redirect = reverse('django.contrib.auth.views.password_reset_done')</code></li>
<li class="missed"><code>    if request.method == "POST":</code></li>
<li class="missed"><code>        form = password_reset_form(request.POST)</code></li>
<li class="missed"><code>        if form.is_valid():</code></li>
<li class="missed"><code>            opts = {</code></li>
<li class="ignored"><code>                'use_https': request.is_secure(),</code></li>
<li class="ignored"><code>                'token_generator': token_generator,</code></li>
<li class="ignored"><code>                'from_email': from_email,</code></li>
<li class="ignored"><code>                'email_template_name': email_template_name,</code></li>
<li class="ignored"><code>                'subject_template_name': subject_template_name,</code></li>
<li class="ignored"><code>                'request': request,</code></li>
<li class="ignored"><code>            }</code></li>
<li class="missed"><code>            if is_admin_site:</code></li>
<li class="missed"><code>                opts = dict(opts, domain_override=request.get_host())</code></li>
<li class="missed"><code>            form.save(**opts)</code></li>
<li class="missed"><code>            return HttpResponseRedirect(post_reset_redirect)</code></li>
<li class="ignored"><code>    else:</code></li>
<li class="missed"><code>        form = password_reset_form()</code></li>
<li class="missed"><code>    context = {</code></li>
<li class="ignored"><code>        'form': form,</code></li>
<li class="ignored"><code>    }</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>def password_reset_done(request,</code></li>
<li class="ignored"><code>                        template_name='registration/password_reset_done.html',</code></li>
<li class="ignored"><code>                        current_app=None, extra_context=None):</code></li>
<li class="missed"><code>    context = {}</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="ignored"><code># Doesn't need csrf_protect since no-one can guess the URL</code></li>
<li class="missed"><code>@sensitive_post_parameters()</code></li>
<li class="missed"><code>@never_cache</code></li>
<li class="missed"><code>def password_reset_confirm(request, uidb36=None, token=None,</code></li>
<li class="ignored"><code>                           template_name='registration/password_reset_confirm.html',</code></li>
<li class="ignored"><code>                           token_generator=default_token_generator,</code></li>
<li class="ignored"><code>                           set_password_form=SetPasswordForm,</code></li>
<li class="ignored"><code>                           post_reset_redirect=None,</code></li>
<li class="ignored"><code>                           current_app=None, extra_context=None):</code></li>
<li class="ignored"><code>    """</code></li>
<li class="ignored"><code>    View that checks the hash in a password reset link and presents a</code></li>
<li class="ignored"><code>    form for entering a new password.</code></li>
<li class="ignored"><code>    """</code></li>
<li class="missed"><code>    assert uidb36 is not None and token is not None # checked by URLconf</code></li>
<li class="missed"><code>    if post_reset_redirect is None:</code></li>
<li class="missed"><code>        post_reset_redirect = reverse('django.contrib.auth.views.password_reset_complete')</code></li>
<li class="missed"><code>    try:</code></li>
<li class="missed"><code>        uid_int = base36_to_int(uidb36)</code></li>
<li class="missed"><code>        user = User.objects.get(id=uid_int)</code></li>
<li class="missed"><code>    except (ValueError, User.DoesNotExist):</code></li>
<li class="missed"><code>        user = None</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>    if user is not None and token_generator.check_token(user, token):</code></li>
<li class="missed"><code>        validlink = True</code></li>
<li class="missed"><code>        if request.method == 'POST':</code></li>
<li class="missed"><code>            form = set_password_form(user, request.POST)</code></li>
<li class="missed"><code>            if form.is_valid():</code></li>
<li class="missed"><code>                form.save()</code></li>
<li class="missed"><code>                return HttpResponseRedirect(post_reset_redirect)</code></li>
<li class="ignored"><code>        else:</code></li>
<li class="missed"><code>            form = set_password_form(None)</code></li>
<li class="ignored"><code>    else:</code></li>
<li class="missed"><code>        validlink = False</code></li>
<li class="missed"><code>        form = None</code></li>
<li class="missed"><code>    context = {</code></li>
<li class="ignored"><code>        'form': form,</code></li>
<li class="ignored"><code>        'validlink': validlink,</code></li>
<li class="ignored"><code>    }</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>def password_reset_complete(request,</code></li>
<li class="ignored"><code>                            template_name='registration/password_reset_complete.html',</code></li>
<li class="ignored"><code>                            current_app=None, extra_context=None):</code></li>
<li class="missed"><code>    context = {</code></li>
<li class="ignored"><code>        'login_url': settings.LOGIN_URL</code></li>
<li class="ignored"><code>    }</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>@sensitive_post_parameters()</code></li>
<li class="missed"><code>@csrf_protect</code></li>
<li class="missed"><code>@login_required</code></li>
<li class="missed"><code>def password_change(request,</code></li>
<li class="ignored"><code>                    template_name='registration/password_change_form.html',</code></li>
<li class="ignored"><code>                    post_change_redirect=None,</code></li>
<li class="ignored"><code>                    password_change_form=PasswordChangeForm,</code></li>
<li class="ignored"><code>                    current_app=None, extra_context=None):</code></li>
<li class="missed"><code>    if post_change_redirect is None:</code></li>
<li class="missed"><code>        post_change_redirect = reverse('django.contrib.auth.views.password_change_done')</code></li>
<li class="missed"><code>    if request.method == "POST":</code></li>
<li class="missed"><code>        form = password_change_form(user=request.user, data=request.POST)</code></li>
<li class="missed"><code>        if form.is_valid():</code></li>
<li class="missed"><code>            form.save()</code></li>
<li class="missed"><code>            return HttpResponseRedirect(post_change_redirect)</code></li>
<li class="ignored"><code>    else:</code></li>
<li class="missed"><code>        form = password_change_form(user=request.user)</code></li>
<li class="missed"><code>    context = {</code></li>
<li class="ignored"><code>        'form': form,</code></li>
<li class="ignored"><code>    }</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>@login_required</code></li>
<li class="missed"><code>def password_change_done(request,</code></li>
<li class="ignored"><code>                         template_name='registration/password_change_done.html',</code></li>
<li class="ignored"><code>                         current_app=None, extra_context=None):</code></li>
<li class="missed"><code>    context = {}</code></li>
<li class="missed"><code>    if extra_context is not None:</code></li>
<li class="missed"><code>        context.update(extra_context)</code></li>
<li class="missed"><code>    return TemplateResponse(request, template_name, context,</code></li>
<li class="ignored"><code>                            current_app=current_app)</code></li>
  </ol>
</div>

<div class="nav">
  <a href="django.contrib.auth.tokens.html">django.contrib.auth.tokens</a> &lt;&lt;
  <a href="../index.html">index</a>
  &gt;&gt; <a href="django.contrib.contenttypes.generic.html">django.contrib.contenttypes.generic</a>
</div>

  </body>
</html>

