function rejectionHandler(e){throw Ember.Logger.error(e,e.message),e}var get=Ember.get,set=Ember.set;DS.DjangoTastypieSerializer=DS.JSONSerializer.extend({init:function(){this._super(),this.configure({meta:"meta",since:"next"})},getItemUrl:function(e,t){var n;return n=get(this,"adapter").rootForType(e.type),["",get(this,"namespace"),n,t,""].join("/")},keyForBelongsTo:function(e,t){return this.keyForAttributeName(e,t)+"_id"},addBelongsTo:function(e,t,n,r){var i,s=get(t,r.key),o=this.embeddedType(t.constructor,n);o==="always"?e[n]=s.serialize():(i=get(s,this.primaryKey(s)),Ember.isNone(i)||(e[n]=this.getItemUrl(r,i)))},addHasMany:function(e,t,n,r){var i=this,s=[],o=null,u=this.embeddedType(t.constructor,n);n=this.keyForHasMany(r.type,n),value=t.get(n)||[],value.forEach(function(e){u==="always"?s.push(e.serialize()):(o=get(e,i.primaryKey(e)),Ember.isNone(o)||s.push(i.getItemUrl(r,o)))}),e[n]=s},extract:function(e,t,n,r){this.extractMeta(e,n,t),this.sideload(e,n,t),t&&(r&&e.updateId(r,t),this.extractRecordRepresentation(e,n,t))},extractMany:function(e,t,n,r){this.sideload(e,n,t),this.extractMeta(e,n,t);if(t.objects){var i=t.objects,s=[];r&&(r=r.toArray());for(var o=0;o<i.length;o++){r&&e.updateId(r[o],i[o]);var u=this.extractRecordRepresentation(e,n,i[o]);s.push(u)}e.populateArray(s)}},extractMeta:function(e,t,n){var r=this.configOption(t,"meta"),i=n,s;r&&n[r]&&(i=n[r]),this.metadataMapping.forEach(function(n,r){(s=i[n])&&e.metaForType(t,r,s)})},sideload:function(e,t,n,r){},_deurlify:function(e){return typeof e=="string"?e.split("/").reverse()[1]:e},extractHasMany:function(e,t,n){var r,i=this;return r=t[n],!r||r.forEach(function(e,t,n){n[t]=i._deurlify(e)}),r},extractBelongsTo:function(e,t,n){var r=t[n];return!r||(r=this._deurlify(r)),r}});var get=Ember.get,set=Ember.set;DS.DjangoTastypieAdapter=DS.RESTAdapter.extend({serverDomain:null,namespace:"api/v1",bulkCommit:!1,since:"next",serializer:DS.DjangoTastypieSerializer,init:function(){var e,t;this._super(),t=get(this,"namespace"),Em.assert("tastypie namespace parameter is mandatory.",!!t),e=get(this,"serializer"),set(e,"adapter",this),set(e,"namespace",t)},createRecord:function(e,t,n){var r,i=this.rootForType(t),s=this;return r=n.serialize(),this.ajax(this.buildURL(i),"POST",{data:r}).then(function(r){s.didCreateRecord(e,t,n,r)},function(r){throw s.didError(e,t,n,r),r}).then(null,rejectionHandler)},updateRecord:function(e,t,n){var r,i,s=this.rootForType(t),o=this;return r=get(n,"id"),i=n.serialize(),this.ajax(this.buildURL(s,r),"PUT",{data:i}).then(function(r){o.didUpdateRecord(e,t,n,r)},function(r){throw o.didError(e,t,n,r),r}).then(null,rejectionHandler)},deleteRecord:function(e,t,n){var r,i=this.rootForType(t),s=this;return r=get(n,"id"),this.ajax(this.buildURL(i,r),"DELETE").then(function(r){s.didDeleteRecord(e,t,n,r)},function(r){throw s.didError(e,t,n,r),r}).then(null,rejectionHandler)},findMany:function(e,t,n){var r,i=this.rootForType(t),s=this;return n=this.serializeIds(n),n instanceof Array&&(n="set/"+n.join(";")+"/"),r=this.buildURL(i),r+=n,this.ajax(r,"GET",{success:function(n){this.didFindMany(e,t,n)}}),this.ajax(r,"GET",{}).then(function(n){s.didFindMany(e,t,n)}).then(null,rejectionHandler)},buildURL:function(e,t){var n=this._super(e,t);return n.charAt(n.length-1)!=="/"&&(n+="/"),!this.serverDomain||(n=this.removeTrailingSlash(this.serverDomain)+n),n},sinceQuery:function(e){var t,n;return n={},!e||(t=e.match(/offset=(\d+)/),t=!t||!t[1]?null:t[1],n.offset=t),t?n:null},removeTrailingSlash:function(e){return e.charAt(e.length-1)==="/"?e.slice(0,-1):e},pluralize:function(e){return e}});
