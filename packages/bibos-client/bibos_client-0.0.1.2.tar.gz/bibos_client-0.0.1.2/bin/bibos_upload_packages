#!/usr/bin/env python

import hashlib
import uuid
import netifaces
import os
import sys
import csv

from bibos_utils.bibos_config import BibOSConfig
from bibos_client.admin_client import BibOSAdmin


config = BibOSConfig()
data = config.get_data()

admin_url = data['admin_url']
uid = data['uid']

admin = BibOSAdmin(admin_url)


os.system('get_package_data /tmp/packages.csv')

with open('/tmp/packages.csv') as f:
    package_reader = csv.reader(f, delimiter=';')
    package_data = [p for p in package_reader]

try:
    admin.send_status_info(uid, package_data, None)
except Exception as e:
    print >> sys.stderr, 'Error:', str(e)
    sys.exit(1)

