<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>web Package &mdash; TiddlyWeb 1.4 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="TiddlyWeb 1.4 documentation" href="index.html" />
    <link rel="next" title="challengers Package" href="tiddlyweb.web.challengers.html" />
    <link rel="prev" title="stores Package" href="tiddlyweb.stores.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.web.challengers.html" title="challengers Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.stores.html" title="stores Package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">TiddlyWeb 1.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="web-package">
<h1>web Package<a class="headerlink" href="#web-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">web</span></tt> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-tiddlyweb.web"></span><p>TiddlyWeb web routines.</p>
<p>The routines, modules, etc that are involved in the
presentation and handling of content over the web.</p>
<p>This is the part that makes it Tiddly_Web, not Tiddly
something else.</p>
</div>
<div class="section" id="module-tiddlyweb.web.challenge">
<span id="challenge-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">challenge</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.challenge" title="Permalink to this headline">¶</a></h2>
<p>WSGI App for running the base challenge system, which lists and links
the available challengers. If there is only one, redirect to it.</p>
<dl class="function">
<dt id="tiddlyweb.web.challenge.base">
<tt class="descclassname">tiddlyweb.web.challenge.</tt><tt class="descname">base</tt><big>(</big><em>environ</em>, <em>start_response</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.challenge.base" title="Permalink to this definition">¶</a></dt>
<dd><p>The basic listing page that shows all available
challenger systems. If there is only one, we
redirect to that instead of listing.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.challenge.challenge_get">
<tt class="descclassname">tiddlyweb.web.challenge.</tt><tt class="descname">challenge_get</tt><big>(</big><em>environ</em>, <em>start_response</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.challenge.challenge_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispatch a GET request to the chosen challenger.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.challenge.challenge_post">
<tt class="descclassname">tiddlyweb.web.challenge.</tt><tt class="descname">challenge_post</tt><big>(</big><em>environ</em>, <em>start_response</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.challenge.challenge_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispatch a POST request to the chosen challenger.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.extractor">
<span id="extractor-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">extractor</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.extractor" title="Permalink to this headline">¶</a></h2>
<p>A place for handling the extraction of user credentials from incoming
requests. UserExtract passes to a stack of extractors. If an extractor
returns something other than None, we have found valid data with
which to set tiddlyweb.usersign.</p>
<dl class="class">
<dt id="tiddlyweb.web.extractor.UserExtract">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.extractor.</tt><tt class="descname">UserExtract</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.extractor.UserExtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to set the User, if it can be
found in the request.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.listentities">
<span id="listentities-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">listentities</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.listentities" title="Permalink to this headline">¶</a></h2>
<p>Common code used for listing bags and recipes.</p>
<dl class="function">
<dt id="tiddlyweb.web.listentities.list_entities">
<tt class="descclassname">tiddlyweb.web.listentities.</tt><tt class="descname">list_entities</tt><big>(</big><em>environ</em>, <em>start_response</em>, <em>method_name</em>, <em>store_list=None</em>, <em>serializer_list=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.listentities.list_entities" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all the bags or recipes the current user can read.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.negotiate">
<span id="negotiate-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">negotiate</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.negotiate" title="Permalink to this headline">¶</a></h2>
<p>WSGI Middleware to do pseudo-content negotiation and put the type in
tiddlyweb.type. If extensions are provided on a GET URI that match
extension_types, they win over the Accept header.</p>
<dl class="class">
<dt id="tiddlyweb.web.negotiate.Negotiate">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.negotiate.</tt><tt class="descname">Negotiate</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.negotiate.Negotiate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Perform a form of content negotiation
to provide information to the environment
that will later be used to choose
serializers.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.negotiate.figure_type">
<tt class="descclassname">tiddlyweb.web.negotiate.</tt><tt class="descname">figure_type</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.negotiate.figure_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine either the content-type (for POST, PUT, DELETE)
or accept header (for GET) and put that information
in tiddlyweb.type in the environment.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.query">
<span id="query-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">query</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.query" title="Permalink to this headline">¶</a></h2>
<p>WSGI Middleware that extracts CGI parameters from the QUERY_STRING and
puts them in tiddlyweb.query in the same structure that cgi.py users
(dictionary of lists). If the current request is a POST of form data,
parse that stuff too.</p>
<dl class="class">
<dt id="tiddlyweb.web.query.Query">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.query.</tt><tt class="descname">Query</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.query.Query" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Extract CGI parameter data from QUERY_STRING and POSTed form data.</p>
<dl class="method">
<dt id="tiddlyweb.web.query.Query.extract_query">
<tt class="descname">extract_query</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.query.Query.extract_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the QUERY_STRING and body (if a POSTed form) to extract
query paremeters. Put the results in tiddlyweb.query.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.sendentity">
<span id="sendentity-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">sendentity</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.sendentity" title="Permalink to this headline">¶</a></h2>
<p>Send a bag or recipe out HTTP, first serializing to the correct type.
This consolidates common code for bags and recipes.</p>
<dl class="function">
<dt id="tiddlyweb.web.sendentity.send_entity">
<tt class="descclassname">tiddlyweb.web.sendentity.</tt><tt class="descname">send_entity</tt><big>(</big><em>environ</em>, <em>start_response</em>, <em>entity</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.sendentity.send_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a bag or recipe out HTTP, first serializing to
the correct type. If the incoming etag matches, raise
304.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.sendtiddlers">
<span id="sendtiddlers-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">sendtiddlers</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.sendtiddlers" title="Permalink to this headline">¶</a></h2>
<p>Routines related to sending a list of tiddlers out to the web,
including filter those tiddlers and validating request cache headers.</p>
<dl class="function">
<dt id="tiddlyweb.web.sendtiddlers.send_tiddlers">
<tt class="descclassname">tiddlyweb.web.sendtiddlers.</tt><tt class="descname">send_tiddlers</tt><big>(</big><em>environ</em>, <em>start_response</em>, <em>tiddlers=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.sendtiddlers.send_tiddlers" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the tiddlers contained in the provided
Tiddlers collection in a Negotiated representation.
Often, but not always, a wiki.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.serve">
<span id="serve-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">serve</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.serve" title="Permalink to this headline">¶</a></h2>
<p>Functions and Classes for running a TiddlyWeb server, including
optionally a built in web server.</p>
<dl class="class">
<dt id="tiddlyweb.web.serve.Configurator">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">Configurator</tt><big>(</big><em>application</em>, <em>config</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.Configurator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI middleware to handle setting a config dict
for every request.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.serve.RequestStarter">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">RequestStarter</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.RequestStarter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI middleware that logs basic request information and cleans
PATH_INFO in the environment.</p>
<dl class="method">
<dt id="tiddlyweb.web.serve.RequestStarter.clean_path_info">
<tt class="descname">clean_path_info</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.RequestStarter.clean_path_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean <tt class="docutils literal"><span class="pre">PATH_INFO</span></tt> in the environment.</p>
<p>This is necessary because WSGI servers tend to decode
the URI before putting it in PATH_INFO. This means that
uri encoded data, such as the <tt class="docutils literal"><span class="pre">%2F</span></tt> encoding of <tt class="docutils literal"><span class="pre">/</span></tt>
will be decoded before we get to route dispatch handling,
by which time the <tt class="docutils literal"><span class="pre">/</span></tt> is treated as a separator. People
say that the right thing to do here is not use <tt class="docutils literal"><span class="pre">%2F</span></tt>.
This is hogwash. The right thing to do is not decode
PATH_INFO. In this solution if REQUEST_URI is present
we use a portion of it to set PATH_INFO.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.serve.load_app">
<tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">load_app</tt><big>(</big><em>app_prefix=None</em>, <em>dirname=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.load_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Create our application from a series of layers. The innermost
layer is a selector application based on urls_map in config. This
is surround by wrappers, which either set something in the
environment, modify the request, or transform output.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.serve.start_server">
<tt class="descclassname">tiddlyweb.web.serve.</tt><tt class="descname">start_server</tt><big>(</big><em>config</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.serve.start_server" title="Permalink to this definition">¶</a></dt>
<dd><p>Start a simple webserver to run our app.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.util">
<span id="util-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">util</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.util" title="Permalink to this headline">¶</a></h2>
<p>General utility routines shared by various web related modules.</p>
<dl class="function">
<dt id="tiddlyweb.web.util.bag_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">bag_etag</tt><big>(</big><em>environ</em>, <em>bag</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.bag_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag for a bag.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.bag_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">bag_url</tt><big>(</big><em>environ</em>, <em>bag</em>, <em>full=True</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.bag_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a URL for a bag.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.check_bag_constraint">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">check_bag_constraint</tt><big>(</big><em>environ</em>, <em>bag</em>, <em>constraint</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.check_bag_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Check to see if the bag allows the current user
to perform the requested action. Lets NoBagError
raise.</p>
<p>This is a web util because user and store come from
environ.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.check_incoming_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">check_incoming_etag</tt><big>(</big><em>environ</em>, <em>etag_string</em>, <em>cache_control='no-cache'</em>, <em>last_modified=None</em>, <em>vary='Accept'</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.check_incoming_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise 304 if the provided etag is the same as that found in the
If-None-Match header of the incoming request.</p>
<p>Return incoming_etag to indicate that an etag was there but
did not match.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.check_last_modified">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">check_last_modified</tt><big>(</big><em>environ</em>, <em>last_modified_string</em>, <em>etag=''</em>, <em>cache_control='no-cache'</em>, <em>vary='Accept'</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.check_last_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise <cite>HTTP304</cite> if If-Modified-Since header matches <cite>last_modified_string</cite></p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.content_length_and_type">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">content_length_and_type</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.content_length_and_type" title="Permalink to this definition">¶</a></dt>
<dd><p>To PUT or POST we must have content-length and content-type
headers. Raise 400 if we cannot get these things.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.datetime_from_http_date">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">datetime_from_http_date</tt><big>(</big><em>http_datestring</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.datetime_from_http_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn an HTTP formatted date into a datetime object.
Returns <cite>None</cite> if date string is invalid.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.encode_name">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">encode_name</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.encode_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode a unicode as utf-8 and then url encode that
string. Use for entity titles in URLs.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.entity_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">entity_etag</tt><big>(</big><em>environ</em>, <em>entity</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.entity_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag from the JSON rep of an entity.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.escape_attribute_value">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">escape_attribute_value</tt><big>(</big><em>text</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.escape_attribute_value" title="Permalink to this definition">¶</a></dt>
<dd><p>escape common character entities, incuding double quotes
in attribute values</p>
<p>This assumes values are enclosed in double quotes (key=&#8221;value&#8221;).</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.get_route_value">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">get_route_value</tt><big>(</big><em>environ</em>, <em>name</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.get_route_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and decode from UTF-8 data provided in WSGI route.</p>
<p>If name is not present in the route, allow KeyError to raise.</p>
<p>If the provided data is not URI escaped UTF-8, raise an HTTP400</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.get_serialize_type">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">get_serialize_type</tt><big>(</big><em>environ</em>, <em>collection=False</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.get_serialize_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Look in the environ to determine which serializer
we should use for this request.</p>
<p>If collection is True, then the presence of an extension which
does not match any serializer should lead to a 415.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.handle_extension">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">handle_extension</tt><big>(</big><em>environ</em>, <em>resource_name</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.handle_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for an extension on the provided resource_name and
trim it off to give the &#8220;real&#8221; resource_name.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.html_encode">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">html_encode</tt><big>(</big><em>text</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.html_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode &amp;, &lt; and &gt; entities in text that will
be used in/as HTML.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.html_frame">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">html_frame</tt><big>(</big><em>environ</em>, <em>title=''</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.html_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the header and footer from the current HTML serialization.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.http_date_from_timestamp">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">http_date_from_timestamp</tt><big>(</big><em>timestamp</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.http_date_from_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a modifier or created tiddler timestamp
into a proper formatted HTTP date. If the timestamp
is invalid use now as the timestamp.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.make_cookie">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">make_cookie</tt><big>(</big><em>name</em>, <em>value</em>, <em>mac_key=None</em>, <em>path=None</em>, <em>expires=None</em>, <em>httponly=True</em>, <em>domain=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.make_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a cookie string, optionally with a MAC, path and
expires value. Expires is in seconds.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.read_request_body">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">read_request_body</tt><big>(</big><em>environ</em>, <em>length</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.read_request_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the wsgi.input representing the request body.
Length is required because it is tested for existence
earlier in the process so we don&#8217;t want to bother
recalculating.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.recipe_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">recipe_etag</tt><big>(</big><em>environ</em>, <em>recipe</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.recipe_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag for a recipe.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.recipe_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">recipe_url</tt><big>(</big><em>environ</em>, <em>recipe</em>, <em>full=True</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.recipe_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a URL for a recipe.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.server_base_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">server_base_url</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.server_base_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Using information in tiddlyweb.config, construct
the base URL of the server, sans the trailing /.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.server_host_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">server_host_url</tt><big>(</big><em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.server_host_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the scheme and host portion of our server url.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.tiddler_etag">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">tiddler_etag</tt><big>(</big><em>environ</em>, <em>tiddler</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.tiddler_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an etag for a tiddler from the tiddler&#8217;s attributes,
but not its text.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.util.tiddler_url">
<tt class="descclassname">tiddlyweb.web.util.</tt><tt class="descname">tiddler_url</tt><big>(</big><em>environ</em>, <em>tiddler</em>, <em>container='bags'</em>, <em>full=True</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.util.tiddler_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a URL for a tiddler.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.validator">
<span id="validator-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">validator</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.validator" title="Permalink to this headline">¶</a></h2>
<p>A collection of routines for validating, santizing and otherwise messing
with content coming in from the web to be tiddlers, bags or recipes.</p>
<p>The validators can be extended by adding functions to the BAG_VALIDATORS,
RECIPE_VALIDATORS and TIDDLER_VALIDATORS. The functions take an
entity object, and an optional environ dict.</p>
<dl class="exception">
<dt id="tiddlyweb.web.validator.InvalidBagError">
<em class="property">exception </em><tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">InvalidBagError</tt><a class="headerlink" href="#tiddlyweb.web.validator.InvalidBagError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
<p>The provided bag has not passed a validation routine
and has been rejected. The caller should stop processing
and return an error to calling code or user-agent.</p>
</dd></dl>

<dl class="exception">
<dt id="tiddlyweb.web.validator.InvalidRecipeError">
<em class="property">exception </em><tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">InvalidRecipeError</tt><a class="headerlink" href="#tiddlyweb.web.validator.InvalidRecipeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
<p>The provided recipe has not passed a validation routine
and has been rejected. The caller should stop processing
and return an error to calling code or user-agent.</p>
</dd></dl>

<dl class="exception">
<dt id="tiddlyweb.web.validator.InvalidTiddlerError">
<em class="property">exception </em><tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">InvalidTiddlerError</tt><a class="headerlink" href="#tiddlyweb.web.validator.InvalidTiddlerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
<p>The provided tiddler has not passed a validation routine
and has been rejected. The caller should stop processing
and return an error to calling code or user-agent.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.sanitize_desc">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">sanitize_desc</tt><big>(</big><em>entity</em>, <em>environ</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.sanitize_desc" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip any bad HTML which may be present in a
bag or recipe description.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.sanitize_html_fragment">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">sanitize_html_fragment</tt><big>(</big><em>fragment</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.sanitize_html_fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Santize an html fragment, returning a copy of the fragment,
cleaned up.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.validate_bag">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">validate_bag</tt><big>(</big><em>bag</em>, <em>environ=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.validate_bag" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the bag to each of the functions in
BAG_VALIDATORS, in order, either changing
the content of the bags&#8217;s attributes, or if
some aspect of the bag can not be accepted
raising InvalidBagError.</p>
<p>BAG_VALIDATORS is an empty list which should
be extended by TiddlyWeb administrators.</p>
<p>validate_bag is called whenever a bag is PUT
via the web.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.validate_recipe">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">validate_recipe</tt><big>(</big><em>recipe</em>, <em>environ=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.validate_recipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the recipe to each of the functions in
RECIPE_VALIDATORS, in order, either changing
the content of the recipes&#8217;s attributes, or if
some aspect of the recipe can not be accepted
raising InvalidRecipeError.</p>
<p>RECIPE_VALIDATORS is an empty list which should
be extended by TiddlyWeb administrators.</p>
<p>validate_recipe is called whenever a recipe is PUT
via the web.</p>
</dd></dl>

<dl class="function">
<dt id="tiddlyweb.web.validator.validate_tiddler">
<tt class="descclassname">tiddlyweb.web.validator.</tt><tt class="descname">validate_tiddler</tt><big>(</big><em>tiddler</em>, <em>environ=None</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.validator.validate_tiddler" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass the tiddler to each of the functions in
TIDDLER_VALIDATORS, in order, either changing
the content of the tiddler&#8217;s attributes, or if
some aspect of the tiddler can not be accepted
raising InvalidTiddlerError.</p>
<p>TIDDLER_VALIDATORS is an empty list which should
be extended by TiddlyWeb administrators.</p>
<p>validate_tiddler is called from web handlers,
when the the accept constraint on the bag containing
the tiddler does not pass.</p>
</dd></dl>

</div>
<div class="section" id="module-tiddlyweb.web.wsgi">
<span id="wsgi-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">wsgi</span></tt> Module<a class="headerlink" href="#module-tiddlyweb.web.wsgi" title="Permalink to this headline">¶</a></h2>
<p>WSGI Middleware apps that haven&#8217;t gotten around to being extracted to
their own modules.</p>
<dl class="class">
<dt id="tiddlyweb.web.wsgi.EncodeUTF8">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">EncodeUTF8</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.EncodeUTF8" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to ensure that the content we send out the pipe is encoded
as UTF-8. Within the application content is _unicode_ (i.e. not encoded).</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.Header">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">Header</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.Header" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>If REQUEST_METHOD is HEAD, change it to GET and
consume the output for lower requests.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.PermissionsExceptor">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">PermissionsExceptor</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.PermissionsExceptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Trap permissions exceptions and turn them into HTTP
exceptions so the errors are propagated to client
code.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.SimpleLog">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">SimpleLog</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.SimpleLog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to write a very simple log to stdout.</p>
<p>Borrowed from Paste Translogger</p>
<dl class="attribute">
<dt id="tiddlyweb.web.wsgi.SimpleLog.format">
<tt class="descname">format</tt><em class="property"> = '%(REMOTE_ADDR)s - %(REMOTE_USER)s [%(time)s] &quot;%(REQUEST_METHOD)s %(REQUEST_URI)s %(HTTP_VERSION)s&quot; %(status)s %(bytes)s &quot;%(HTTP_REFERER)s&quot; &quot;%(HTTP_USER_AGENT)s&quot;'</em><a class="headerlink" href="#tiddlyweb.web.wsgi.SimpleLog.format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tiddlyweb.web.wsgi.SimpleLog.write_log">
<tt class="descname">write_log</tt><big>(</big><em>environ</em>, <em>req_uri</em>, <em>status</em>, <em>size</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.SimpleLog.write_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the log info out in a formatted form to logging.info.</p>
<p>This is rather more complex than desirable because there is
a mix of str and unicode in the gathered data and we need to
make it acceptable for output.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.StoreSet">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">StoreSet</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.StoreSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware that sets our choice of Store (tiddlyweb.store)
in the environment.</p>
</dd></dl>

<dl class="class">
<dt id="tiddlyweb.web.wsgi.TransformProtect">
<em class="property">class </em><tt class="descclassname">tiddlyweb.web.wsgi.</tt><tt class="descname">TransformProtect</tt><big>(</big><em>application</em><big>)</big><a class="headerlink" href="#tiddlyweb.web.wsgi.TransformProtect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>WSGI Middleware to add a Cache-Control no-transform so that mobile
companies that transcode content over their 3G (etc) networks don&#8217;t,
as it will break various JavaScript things, including TiddlyWiki.</p>
</dd></dl>

</div>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="tiddlyweb.web.challengers.html">challengers Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.challengers.html#id1"><tt class="docutils literal"><span class="pre">challengers</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.challengers.html#module-tiddlyweb.web.challengers.cookie_form"><tt class="docutils literal"><span class="pre">cookie_form</span></tt> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tiddlyweb.web.extractors.html">extractors Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.extractors.html#id1"><tt class="docutils literal"><span class="pre">extractors</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.extractors.html#module-tiddlyweb.web.extractors.http_basic"><tt class="docutils literal"><span class="pre">http_basic</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.extractors.html#module-tiddlyweb.web.extractors.simple_cookie"><tt class="docutils literal"><span class="pre">simple_cookie</span></tt> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tiddlyweb.web.handler.html">handler Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#id1"><tt class="docutils literal"><span class="pre">handler</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.bag"><tt class="docutils literal"><span class="pre">bag</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.chronicle"><tt class="docutils literal"><span class="pre">chronicle</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.recipe"><tt class="docutils literal"><span class="pre">recipe</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.search"><tt class="docutils literal"><span class="pre">search</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiddlyweb.web.handler.html#module-tiddlyweb.web.handler.tiddler"><tt class="docutils literal"><span class="pre">tiddler</span></tt> Module</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">web Package</a><ul>
<li><a class="reference internal" href="#id1"><tt class="docutils literal"><span class="pre">web</span></tt> Package</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.challenge"><tt class="docutils literal"><span class="pre">challenge</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.extractor"><tt class="docutils literal"><span class="pre">extractor</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.listentities"><tt class="docutils literal"><span class="pre">listentities</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.negotiate"><tt class="docutils literal"><span class="pre">negotiate</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.query"><tt class="docutils literal"><span class="pre">query</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.sendentity"><tt class="docutils literal"><span class="pre">sendentity</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.sendtiddlers"><tt class="docutils literal"><span class="pre">sendtiddlers</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.serve"><tt class="docutils literal"><span class="pre">serve</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.util"><tt class="docutils literal"><span class="pre">util</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.validator"><tt class="docutils literal"><span class="pre">validator</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-tiddlyweb.web.wsgi"><tt class="docutils literal"><span class="pre">wsgi</span></tt> Module</a></li>
<li><a class="reference internal" href="#subpackages">Subpackages</a><ul>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tiddlyweb.stores.html"
                        title="previous chapter">stores Package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tiddlyweb.web.challengers.html"
                        title="next chapter">challengers Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tiddlyweb.web.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.web.challengers.html" title="challengers Package"
             >next</a> |</li>
        <li class="right" >
          <a href="tiddlyweb.stores.html" title="stores Package"
             >previous</a> |</li>
        <li><a href="index.html">TiddlyWeb 1.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Chris Dent.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>