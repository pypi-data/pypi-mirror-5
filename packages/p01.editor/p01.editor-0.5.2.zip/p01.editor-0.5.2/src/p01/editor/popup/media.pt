<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" i18n:domain="p01">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="xEditorDialog.css" media="screen"
      tal:attributes="href context/++resource++xEditorDialog.css" />
<script type="text/javascript" src="jquery.js"
        tal:attributes="src context/++resource++jquery.js"> </script>
<script>
function createMedia() {
    width = $('#inpWidth').val()
    height = $('#inpHeight').val();
    url = $('#inpURL').val();
    if($('#chkAutoStart').is(':checked'))sAutoStart="true";
    else sAutoStart="false";

    if($('#chkShowControls').is(':checked'))sShowControls="true";
    else sShowControls="false";

    if($('#chkAutoRewind').is(':checked'))sAutoRewind="true";
    else sAutoRewind="false";

  var sHTML = "<object selThis=\"selThis\" width='"+width+"' height='"+height+"' "+
    "classid='CLSID:6BF52A52-394A-11D3-B153-00C04F79FAA6' "+
    "codebase='http://www.microsoft.com/Windows/Downloads/Contents/MediaPlayer/' >"+
    "<param name='URL' value='"+url+"'>"+
    "<param name='autoStart' value='"+sAutoStart+"'>"+
    "<param name='uiMode' value='"+(sShowControls=="true"?"full":"none")+"'>"+
    "<param name='playCount' value='"+(sAutoRewind=="true"?32767:1)+"'>"+
    " <embed "+
    " type='application/x-mplayer2' "+
    " pluginspage='http://www.microsoft.com/Windows/Downloads/Contents/MediaPlayer/' "+
    " width='"+width+"' "+
    " height='"+height+"' "+
    " src='"+url+"' "+
    " filename='"+url+"' "+
    " autostart='"+(sAutoStart=="true"?"1":"0")+"' "+
    " showcontrols='"+(sShowControls=="true"?"1":"0")+"' "+
    " showstatusbar='"+"0"+"' "+
    " showdisplay='"+"0"+"' "+
    " autorewind='"+(sAutoRewind=="true"?"1":"0")+"'\>"+
    " <"+"/embed>"+
    "<"+"/object>";
    return sHTML 
}

function insertMedia() {
  var sHTML = createMedia();
  parent.insertXEditorHTML(sHTML);
  j01DialogClose();
}

function updateMedia() {
  var sHTML = createMedia();
  parent.updateXEditorMedia(sHTML);
  j01DialogClose();
}

$(document).ready(function(){
    // enable cancel button
    $('#btnCancel').css('display', 'block');
    if (parent.activeXEditorMediaData) {
        // enable update button
        $('#btnApply').css('display', 'block');
        // set initial url and target the selected node was an anchor
        $("#inpURL").val(parent.activeXEditorMediaData['url']);
        $("#inpWidth").val(parent.activeXEditorMediaData['width']);
        $("#inpHeight").val(parent.activeXEditorMediaData['height']);

        if (parent.activeXEditorMediaData['playCount'] == '32767') {
            $("#chkAutoRewind").attr('checked','checked');
        }
        if (parent.activeXEditorMediaData['autoStart']) {
            $("#chkAutoStart").attr('checked','checked');
        }
        if (parent.activeXEditorMediaData['uiMode'] == 'full') {
            $("#chkShowControls").attr('checked','checked');
        }
        parent.activeXEditorMediaData = null;
    }else{
        // enable insert button
        $('#btnInsert').css('display', 'block');
    }
})
</script>
</head>
<body style="overflow:hidden;">
<table width="100%" height="100%" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td valign="top" style="padding:5;height:100%">
      <table cellpadding="2" cellspacing="0"  style="width:100%">
        <tr>
          <td nowrap><span>Source</span>:&nbsp;&nbsp;</td>
          <td colspan="4" style="width:100%">
            <input type="text" id=inpURL size="45" value="" style="width:100%" class="inpTxt">
          </td>
        </tr>
        <tr>
          <td nowrap="nowrap"><span>Width</span>:</td>
          <td colspan="4">
            <input type="text" id="inpWidth" value="320" size="2" class="inpTxt">
          </td>
        </tr>
        <tr>
          <td nowrap="nowrap"><span>Height</span>:</td>
          <td colspan="4">
            <input type="text" id="inpHeight" value="290" size="4" class="inpTxt">
          </td>
        </tr>
        <tr>
          <td nowrap="nowrap"><span>Auto Start</span>:</td>
          <td>
            <input type="checkbox" id="chkAutoStart" class="inpChk" value="true">
          </td>
          <td colspan="3" rowspan="5">
            &nbsp;
          </td>
        </tr>
        <tr>
          <td nowrap="nowrap"><span>Show Controls</span>:</td>
          <td nowrap="nowrap">
            <input type="checkbox" id="chkShowControls" class="inpChk" value="full">
          </td>
        </tr>
        <tr>
          <td nowrap="nowrap"><span>Auto Rewind</span>:</td>
          <td nowrap="nowrap">
            <input type="checkbox" id="chkAutoRewind" class="inpChk" value="32767">
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td class="dialogFooter" align="right">
      <table cellpadding="2" cellspacing="0">
        <tr>
          <td>
            <input type="button" id="btnCancel" value="cancel" onclick="j01DialogClose();" class="inpBtn" onmouseover="this.className='inpBtnOver';" onmouseout="this.className='inpBtnOut'">
          </td>
          <td>
            <input type="button" id="btnInsert" value="insert" onclick="insertMedia();" style="display:none" class="inpBtn" onmouseover="this.className='inpBtnOver';" onmouseout="this.className='inpBtnOut'">
          </td>
          <td>
            <input type="button" id="btnApply" value="apply" onclick="updateMedia()" style="display:none" class="inpBtn" onmouseover="this.className='inpBtnOver';" onmouseout="this.className='inpBtnOut'">
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</body>
</html>