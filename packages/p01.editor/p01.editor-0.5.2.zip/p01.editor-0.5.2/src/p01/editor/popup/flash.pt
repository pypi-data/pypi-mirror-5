<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" i18n:domain="p01">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="xEditorDialog.css" media="screen"
      tal:attributes="href context/++resource++xEditorDialog.css" />
<script type="text/javascript" src="jquery.js"
        tal:attributes="src context/++resource++jquery.js"> </script>
<script>
function createFlash() {
    url = $('#inpSwfURL').val()
    width = $('#inpSwfWidth').val();
    height = $('#inpSwfHeight').val();
    isLoop = $("input[name='rdoSwfLoop']:checked").val();

    var sHTML = "<object "+
    "classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' " +
    "width='"+width+"' "+
    "height='"+height+"' " +
    "codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0'>"+
    " <param name='movie' value='"+url+"'>" +
    " <param name='play' value='true'>" +
    " <param name='loop' value='"+isLoop+"'>" +
    " <param name='WMode' value='Opaque'>" +
    " <param name='quality' value='high'>" +
    " <embed "+
    " src='"+url+"' "+
    " width='"+width+"' "+
    " height='"+height+"' "+
    " play='true' "+
    " loop='"+isLoop+"' "+
    " wmode='Opaque' "+
    " quality='high' "+
    " pluginspage='http://www.macromedia.com/go/getflashplayer'\>"+
    " <"+"/embed>"+
    "<"+"/object>";
    return sHTML;
}

function insertFlash() {
  var sHTML = createFlash();
  parent.insertXEditorHTML(sHTML);
  j01DialogClose();
}

function updateFlash() {
  var sHTML = createFlash();
  parent.updateXEditorFlash(sHTML);
  j01DialogClose();
}

$(document).ready(function(){
    if (parent.activeXEditorFlashData) {
        // enable update button
        $('#btnApply').css('display', 'block');
        // set initial url and target the selected node was an anchor
        $("#inpSwfURL").val(parent.activeXEditorFlashData['url']);
        $("#inpSwfWidth").val(parent.activeXEditorFlashData['width']);
        $("#inpSwfHeight").val(parent.activeXEditorFlashData['height']);
        if (parent.activeXEditorFlashData['loop']) {
            $("input[name='rdoSwfLoop']").val(['true']);
        }else{
            $("input[name='rdoSwfLoop']").val(['false']);
        }
        parent.activeXEditorFlashData = null;
    }else{
        // enable insert button
        $('#btnInsert').css('display', 'block');
    }
})
</script>
</head>
<body style="overflow:hidden;">
<form>
<table width="100%" height="100%" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td valign="top" style="padding:5;height:100%">
      <table cellpadding="2" cellspacing="0">
        <tr>
          <td width="90px" nowrap><span>Source</span>:&nbsp;&nbsp;</td>
          <td colspan="4" width="100%">
            <input type="text" id=inpSwfURL style="width:100%" value="" class="inpTxt">
          </td>
        </tr>
        <tr>
          <td nowrap><span>Width</span>:</td>
          <td colspan="4">
            <input type="text" id="inpSwfWidth" value="100" size="4" class="inpTxt">
          </td>
        </tr>
        <tr>
          <td nowrap><span>Height</span>:</td>
          <td colspan="4">
            <input type="text" id="inpSwfHeight" value="100" size="4" class="inpTxt">
          </td>
        </tr>
        <tr>
          <td nowrap><span>Loop</span>:&nbsp;&nbsp;</td>
          <td nowrap colspan="4">
            <input type="radio" name="rdoSwfLoop" value="true"> <span>Yes</span>&nbsp;
            <input type="radio" name="rdoSwfLoop" value="false"> <span>No</span>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td class="dialogFooter" align="right">
      <table cellpadding="0" cellspacing="0">
        <tr>
          <td>
            <input type=button id="btnCancel" value="cancel" onclick="j01DialogClose();" class="inpBtn" onmouseover="this.className='inpBtnOver';" onmouseout="this.className='inpBtnOut'">
          </td>
          <td>
            <input type="button" id="btnInsert" value="insert" onclick="insertFlash();" style="display:none" class="inpBtn" onmouseover="this.className='inpBtnOver';" onmouseout="this.className='inpBtnOut'">
          </td>
          <td>
            <input type="button" id="btnApply" value="apply" onclick="updateFlash()" style="display:none" class="inpBtn" onmouseover="this.className='inpBtnOver';" onmouseout="this.className='inpBtnOut'">
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</form>
</body>
</html>