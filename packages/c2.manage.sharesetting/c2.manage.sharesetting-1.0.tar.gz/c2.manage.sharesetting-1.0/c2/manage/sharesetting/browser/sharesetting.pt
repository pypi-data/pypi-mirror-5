<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
     lang="en"
     metal:use-macro="here/prefs_main_template/macros/master"
     i18n:domain="plone">
<body>
<div metal:fill-slot="prefs_configlet_content">
<style type="text/css"><!--	
.shareSetting {font-size: 80%}

.shareSetting {
	margin: 5px 0;
	border: 1px solid #000000;
}

.shareSetting th,
.shareSetting td {
	border: 1px solid #000000;
}

.shareSetting th {
	background-color: #808080;
	color: #ffffff;
}

.shareSetting th,
.shareSetting td {
	padding: 5px;
}
.sharechecking {
	text-align: center;
}

.share-setting-select,
.share-setting-save {
	padding: 1px;
}
table.shareSetting td a {
	display:block;
	border-left : 1px solid #ccc;
}
/*.shareSettingPathLen1 {padding-left: 0}*/
.shareSettingPathLen2 a{padding-left: 10px}
.shareSettingPathLen3 a{padding-left: 20px}
.shareSettingPathLen4 a{padding-left: 30px}
.shareSettingPathLen5 a{padding-left: 40px}
.shareSettingPathLen6 a{padding-left: 50px}
.shareSettingPathLen7 a{padding-left: 60px}
.shareSettingPathLen8 a{padding-left: 70px}
.shareSettingPathLen9 a{padding-left: 80px}

--></style>
  <h1 class="documentFirstHeading">Share Setting</h1>

  <div class="viewSelect">
	<form action="" method="get">
	    <!-- <span>Review State:</span>
		<select name="reviewstate">
			<option value="all">ALL</option>
			<option value=""
				tal:repeat="state view/get_all_review_state"
				tal:content="python:state[0]"
				tal:attributes="value python:state[1];
				                selected python:view.request.form.get('reviewstate') == state[1] and 'selected' or None" 
				/>
		</select> -->
		<span>Level:</span>
		<select name="filter_level">
			<option value="1"
				tal:repeat="level view/get_filter_levels"
				tal:content="level"
				tal:attributes="value level;
				                selected python:view.filter_level == int(level) and 'selected' or None" 
				/>
		</select>
		&nbsp;&nbsp;<span>Role select:</span>
		<select name="filter_role">
			<option value=""
				tal:repeat="role view/get_all_local_role"
				tal:content="role"
				tal:attributes="value role;
				                selected python:view.request.form.get('filter_role', 'Reader') == role and 'selected' or None" 
				/>
		</select>
		<select name="filter_groups" size="10" multiple="multiple">
			<option value=""
				tal:repeat="group view/get_all_groups"
				tal:content="group"
				tal:attributes="value group;
				                selected python: group in view.request.form.get('filter_groups', []) and 'selected' or None" 
				/>
		</select>
		<input class="share-setting-select" type="submit" name="submit" value="Select" />
	</form>
  </div>
	<div>
		<form action="@@sharesetting-all-contents-list" method="get">
			<input type="hidden" name="filter_level" value=""
				tal:attributes="value python:view.filter_level" />
			<input type="hidden" name="filter_role" value=""
				tal:attributes="value python:view.request.form.get('filter_role', u'Reader')" />
			<input type="hidden" name="filter_groups" value=""
				tal:attributes="value python:view.request.form.get('filter_groups', '')" />
			<input type="submit" name="download" value="Data CSV Download" />
		</form>
	</div>

  <form action="" method="post">
   <table class="shareSetting" border="0" tal:define="groups view/get_groups">
    
    <tal:rep repeat="item view/get_items">
	  <tal:header tal:define="num repeat/item/index"
		          tal:condition="python:num % 15 == 0">
			<p metal:use-macro="here/@@sharesetting-macro/macros/table_header" />
	  </tal:header>	
	  <tr>
		  <tal:obj define="obj item/item/getObject">
			<td tal:attributes="class python:view.get_path_len(obj)">
				<a tal:content="obj/title_or_id" 
					tal:attributes="href string:${item/url}/@@sharing;
									class string:state-${item/state}"></a>
				<input type="hidden" name="entries.uid:records" value="uid"
					tal:attributes="value obj/UID" />
				<input type="hidden" name="entries.role:records" value="role"
					tal:attributes="value item/filter_role" />
			</td>
			<td tal:content="item/state" tal:attributes="class string:state-${item/state}"></td>
			<td class="contenttype" tal:content="item/p_type"></td>
			<td class="sharechecking" tal:repeat="chk python:view.get_item_share(obj)">
				<input type="checkbox" name="" 
						tal:condition="python:chk['chk'] != '2'"
						tal:attributes="name string:entries.group_${chk/group}:records;
										checked python:chk['chk'] and 'checked' or None;"/>
				<img tal:condition="python:chk['chk'] == '2'" 
						tal:replace="structure context/confirm_icon.gif" />
			</td>
		  </tal:obj>
	  </tr>
	</tal:rep>
   </table>
     <input type="hidden" name="form.localRoleSubmited" value="1" />
     <input class="share-setting-save" type="submit" name="localRoleSubmit" value="Save" />
  </form>
</div>
</body>
</html>
