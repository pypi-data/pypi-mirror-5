<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>eduCommons 3.2.1-final SeleniumRC Testing</title>
<meta name="author" content="Santiago Suarez Ordoñez &lt;santiycr &#64; gmail..com&gt;" />
<meta name="copyright" content="This document has been placed in the public domain." />
<link rel="stylesheet" href="./default.css" type="text/css" />
</head>
<body>
<div class="document" id="educommons-3-2-1-final-seleniumrc-testing">
<h1 class="title">eduCommons 3.2.1-final SeleniumRC Testing</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="field"><th class="docinfo-name">Title:</th><td class="field-body">eduCommons SeleniumRC Testing</td>
</tr>
<tr><th class="docinfo-name">Author:</th>
<td>Santiago Suarez Ordoñez &lt;santiycr &#64; gmail..com&gt;</td></tr>
<tr><th class="docinfo-name">Copyright:</th>
<td>This document has been placed in the public domain.</td></tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id3">Introduction</a></li>
<li><a class="reference internal" href="#tests-buildout" id="id4">Tests buildout</a></li>
<li><a class="reference internal" href="#running-the-tests" id="id5">Running the tests</a><ul>
<li><a class="reference internal" href="#the-seleniumrunner-script" id="id6">The seleniumrunner script</a></li>
<li><a class="reference internal" href="#basic-tests-execution" id="id7">Basic tests execution</a></li>
<li><a class="reference internal" href="#additional-parameters" id="id8">Additional parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-test" id="id9">Creating a test</a><ul>
<li><a class="reference internal" href="#tests-development-guidelines" id="id10">Tests development guidelines</a></li>
<li><a class="reference internal" href="#example-test" id="id11">Example test</a></li>
<li><a class="reference internal" href="#the-seleniumwrapper-module" id="id12">The seleniumWrapper module</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id3">Introduction</a></h1>
<p>This guide aims to help people writing and
running tests using the Selenium RC environment and framework
built within eduCommons.</p>
</div>
<div class="section" id="tests-buildout">
<h1><a class="toc-backref" href="#id4">Tests buildout</a></h1>
<p>Originally, the test environment is not being
deployed within the production buildout.
To create an instance in which the tests can be
executed, you should run the buildout using the
test.cfg configuration:</p>
<pre class="literal-block">
$ ./bin/buildout -c tests.cfg
</pre>
<p>Once the buildout is complete, a test runner script should
be located inside the bin folder and a new clean instance will be
created and prepared to run the tests.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">The plone zope instance tu use for the tests will be stored in a
sepparate ZODB to ensure integrity on any production instance.</p>
</div>
</div>
<div class="section" id="running-the-tests">
<h1><a class="toc-backref" href="#id5">Running the tests</a></h1>
<p>To run the suite of tests buldled with eduCommons, the first thing to do after
the tests buildout has been run is to prepare an eduCommons site to test (if the the
user doesn't have a Plone site to test, yet).
For this to be done, you must first wake up the instance:</p>
<pre class="literal-block">
./bin/instance start
</pre>
<p>And then go to the ZMI and follow the procedure of creating an eduCommons Plone site.
Once the site is ready, the user should setup the different user accounts that the tests
will use. This accounts should have the following roles and passwords:</p>
<blockquote>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">../SeleniumRCTests.txt</tt>, line 52)</p>
<p>Malformed table.
Text in column margin at line offset 3.</p>
<pre class="literal-block">
====     =========   =========
Role      Username   Password
====     =========   =========
admin/manager admin  test1234
producer  producer   producer
reviewer  reviewer  reviewer
qa        quality   quality
publisher publisher publisher
viewer    viewer    viewer
=======  =========   =========
</pre>
</div>
<p>Once the instance and the eduCommons test site are ready, the user can run the tests.</p>
</blockquote>
<div class="section" id="the-seleniumrunner-script">
<h2><a class="toc-backref" href="#id6">The seleniumrunner script</a></h2>
<p>The selenium runner is a scipt created to find and run <strong>selenium tests</strong>
for a product.
It receives different parameters and it's main objective is to simplify the
tests execution and reporting procedure.
This script will wake-up the selenium RC server, search and run the tests
and then shutdown the server and report the tests result.</p>
</div>
<div class="section" id="basic-tests-execution">
<h2><a class="toc-backref" href="#id7">Basic tests execution</a></h2>
<p>To run all the selenium tests for a product (e.g. eduCommons)
the user should pass at least two parameters:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-i <var>instance</var></span></kbd></td>
<td>The Plone site's name. This is defaulted to &quot;educommons&quot;.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s <var>product</var></span></kbd></td>
<td>The product in which the runner will search for tests to run.</td></tr>
</tbody>
</table>
<p>An example test execution will be:</p>
<pre class="literal-block">
$ ./bin/seleniumrunner -i educommonsSite -s enpraxis.educommons
</pre>
<p>This will search all the <strong>selenium</strong> tests for the educommons product and
run them on <a class="reference external" href="http://localhost">http://localhost</a>:&lt;port_used&gt;/educommonsSite.</p>
<p>For running  a particular test, the -t parameter should be passed to the runner:</p>
<pre class="literal-block">
$ ./bin/seleniumrunner -i educommonsSite -s enpraxis.educommons -t createPage
</pre>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">Please notice that the createPage.py test should be stored in the
respective location and added to the __init__py file (See <a class="reference internal" href="#creating-a-test">Creating a test</a>)</p>
</div>
</div>
<div class="section" id="additional-parameters">
<h2><a class="toc-backref" href="#id8">Additional parameters</a></h2>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-p <var>port</var></span></kbd></td>
<td>Set the port in which Selenium server will communicate
with the tests.
The default if 4444.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-b <var>browser</var></span></kbd></td>
<td>Set the browser that will be used to run the tests.
<strong>Note</strong>: The tests written to ignore this will still
run using another browser. See the -f parameter to force
these tests to run on a specified browser.
The default value is: &quot;*firefox&quot;, but any browser supported
by selenium can be used (&quot;*iexplore&quot;, &quot;*opera&quot;, even
&quot;*firefox /path/to/firefox-bin&quot;).</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Force all the tests to use the desired browser.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-o</span></kbd></td>
<td>Generate an HTML output as a summary of the results.</td></tr>
</tbody>
</table>
<p>for more details on this, please run:</p>
<pre class="literal-block">
$ ./bin/seleniumrunner -h
</pre>
</div>
</div>
<div class="section" id="creating-a-test">
<h1><a class="toc-backref" href="#id9">Creating a test</a></h1>
<p>The seleniumrunner script will look for all the classes that inherit from
unittest.TestCase on a specified package or module located under this kind of
path:</p>
<pre class="literal-block">
namespace.product/namespace/product/tests/seleniumtests
</pre>
<div class="note">
<p class="first admonition-title">Note</p>
<p>Notice that for adding tests to educommons' selenium tests, the path to add
the tests will end up being:</p>
<pre class="last literal-block">
src/enpraxis.educommons/enpraxis/educommons/tests/seleniumtests
</pre>
</div>
<p>Once the test script has been added to the tests location, it should be
included in the run by adding an import of the test in the <em>__init__.py</em>
file located in the same directory:</p>
<pre class="literal-block">
src/enpraxis.educommons/enpraxis/educommons/tests/seleniumtests/__init__.py
</pre>
<p>For a test to be correctly executed by the seleniumrunner script,
it must follow certain basic rules.</p>
<div class="section" id="tests-development-guidelines">
<h2><a class="toc-backref" href="#id10">Tests development guidelines</a></h2>
<p>To create a test, there are certain basic rules to follow:</p>
<ol class="arabic">
<li><p class="first">The test should inherit from unittest.TestCase class (this can be done
indirectly also).</p>
</li>
<li><p class="first">The test should use certain global variables for the code to work
on different environments and eduCommons instances. These are:</p>
<blockquote>
<ul class="simple">
<li>browser: For the browser used for the tests</li>
<li>port: For the port used to communicate with the server</li>
<li>url: For the url of the application under test</li>
<li>instance: The Plone site name (this depends on
the name used for the site's creation).</li>
</ul>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">../SeleniumRCTests.txt</tt>, line 175)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</div>
<p>This variables should never be changed inside the test code, as the
seleniumrunner script will set them on runtime according with the parameters
received.</p>
</li>
<li><p class="first">The selenium client driver used should be seleniumWrapper instead of
the classic selenium.py that's installed with the recipe (we will go
deeper on this <a class="reference internal" href="#later">later</a>).</p>
</li>
</ol>
<p>All this rules can be seen applied to the following <a class="reference internal" href="#example-test">Example test</a>.</p>
</div>
<div class="section" id="example-test">
<h2><a class="toc-backref" href="#id11">Example test</a></h2>
<p>The following is an example test, it can be used as the basic
structure for future tests:</p>
<pre class="literal-block">
from seleniumWrapper import selenium
import unittest

class NewTest(unittest.TestCase):
    def setUp(self):
        self.verificationErrors = []
        self.selenium = selenium(&quot;localhost&quot;, port, browser, url, instance)
        self.selenium.start()

    def test_new(self):
        sel = self.selenium
        sel.login(&quot;admin&quot;,&quot;test1234&quot;)
        # Do specific tests in here

    def tearDown(self):
        self.selenium.stop()
        self.assertEqual([], self.verificationErrors)
</pre>
<p>Notice that the test doesn't have much changes from the basic
test exported using <a class="reference external" href="http://seleniumhq.org/projects/ide/">Selenium IDE</a>,
the firefox extension. The only differences are the import of the eduCommons
wrapper instead of the standard selenium driver and the variables used for the
instanciation inside the <em>setUp</em> method.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">Please notice that the &quot;instance&quot; variable will have to be used in
each <em>open</em> command for the users to provide the correct location
of the eduCommons plone site to test.</p>
</div>
</div>
<div class="section" id="the-seleniumwrapper-module">
<span id="later"></span><h2><a class="toc-backref" href="#id12">The seleniumWrapper module</a></h2>
<p>This module is (as it's name says) a wrapper for the selenium standard lib.
The reason why we created it is to make tests clean and easier to maintain
by centralizing commonly used code.</p>
<p>Some examples of common methods that the wrapper includes are:</p>
<dl class="docutils">
<dt>login(username, password):</dt>
<dd>This method wraps all the steps needed to log a user and go to the home
page to start a test.</dd>
<dt>validate_breadcrumbs(<a href="#id1"><span class="problematic" id="id2">*</span></a>args):</dt>
<dd><div class="first system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">../SeleniumRCTests.txt</tt>, line 238); <em><a href="#id2">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<p class="last">This method receives multiple strings as parameters and validates that they
are included in the breadcrumbs. Notice that the last string received should
be the page where the test is located at that moment.</p>
</dd>
</dl>
<p>To see the methods included in the wrapper please read the source code, it is
located on <em>enpraxis.educommons/enpraxis/educommons/tests/seleniumtests/seleniumWrapper.py</em></p>
</div>
</div>
</div>
<div class="footer">
<hr class="footer" />
<a class="reference external" href="SeleniumRCTests.txt">View document source</a>.
Generated on: 2009-08-18 05:41 UTC.
Generated by <a class="reference external" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>
