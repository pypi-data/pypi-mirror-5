#!/usr/bin/env python

import sys
from tek_utils.iptables import Iptables

def main():
    try:
        iptables = Iptables()
        iptables.flush()
        iptables.flush('nat')
        iptables.delete_chains()
        if len(sys.argv) > 1 and sys.argv[1] == "allopen":
            iptables.allopen()
        elif len(sys.argv) > 1 and sys.argv[1] == "minimal":
            iptables.setup_local()
        else:
            iptables.setup_local()
            iptables.setup_lan_hosts()
            iptables.setup_ports()
            iptables.launch()
    except Exception, e:
        print e

if __name__ == "__main__": main()
