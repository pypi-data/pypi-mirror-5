<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="seantis.reservation"
>

<body>
<metal:main fill-slot="main">
<tal:main-macro metal:define-macro="main">

<div tal:attributes="data-group python: view.highlight_group; class python: view.hide_waitinglist and 'inline-reservations hide-waitinglist' or 'inline-reservations'">
  
  <div class="uncommitted" i18n:translate="" tal:condition="view/uncommitted_reservations_count">
    <tal:block content="view/uncommitted_reservations"></tal:block>
  </div>

  <div class="splitscreen splitleft">

    <h2 class="documentFirstHeading" i18n:translate="">Reservations</h2>
    
    <div class="reservation-info reservation-approved" metal:define-macro="approved_reservations">
        
        <tal:block tal:repeat="group python: view.approved_reservations().items()">
          <tal:block define="
              token python: group[0];
              reservations python: group[1];
              data python: view.extended_info(token);
            ">

            <div class="reservation">

                <div class="reservation-title">
                    
                    <h3 tal:content="python: view.reservation_info(token)"></h3>

                    <a tal:condition="view/show_links"
                       tal:attributes="href python: view.remove_all_url(token)"
                       class="reservation-delete" i18n:translate="">
                       Revoke
                    </a>

                </div>

                <div tal:repeat="reservation reservations" class="reservation-list">

                  <div class="reservation-data" metal:define-macro="reservation_data">
                    
                    <tal:block tal:condition="data" tal:repeat="key python: view.sorted_info_keys(data)">
                      <tal:block tal:define="interface python: data[key]">
                        
                        <div class="block-title" tal:content="python: interface['desc']"></div>
                        
                        <div tal:repeat="value python: view.sorted_values(interface['values'])">
                          <span class="label" tal:content="python: value['desc']"></span><span tal:content="python: view.display_info(value['value'])"></span>
                        </div>
                      
                      </tal:block>
                    </tal:block>
                  
                  </div>

                  <div class="reservation-timespans" metal:define-macro="reservation_timespans">
                    
                    <div class="block-title" i18n:translate="">Concerned Dates</div>
                    <div class="limitedList" style="max-height: 450px; min-width: 100%;">
                    
                    <tal:block tal:repeat="timespan python: sorted(reservation.timespans())">
                        <tal:block tal:define="
                        start python: timespan[0];
                        end python: timespan[1];
                        display python: view.display_date(start, end);
                        ">
                          <div tal:content="display"></div>
                        </tal:block>
                    </tal:block>

                    </div>
                  </div>

                  <div style="clear: both;"></div>
                </div>
            </div>

            <div class="reservation-quota" tal:condition="python: view.reservation_quota(token) > 1" tal:attributes="data-reservation-quota python: view.reservation_quota(token)">
              <tal:block content="structure python: view.reservation_quota_text(token)"></tal:block>
            </div>
          </tal:block>

        </tal:block>
    </div>
  </div>
  <div class="splitscreen splitright">
   
    <h2 class="documentFirstHeading" i18n:translate="">Waitinglist</h2>
    
    <div class="reservation-info reservation-pending" metal:define-macro="pending_reservations">
        
        <tal:block tal:repeat="group python: view.pending_reservations().items()">
          <tal:block define="
              token python: group[0];
              reservations python: group[1];
              data python: view.extended_info(token);
            ">
            <div class="reservation">

                <div class="reservation-title">
                    <h3>
                      <b tal:condition="python: view.show_links"><tal:block content="repeat/group/number"></tal:block></b>&nbsp;
                      <tal:block tal:content="python: view.reservation_info(token)"></tal:block>
                    </h3>

                    <a tal:condition="view/show_links"
                      tal:attributes="href python: view.deny_all_url(token)"
                      class="reservation-delete" i18n:translate="">
                      Deny
                    </a>

                    <a tal:condition="view/show_links"
                       tal:attributes="href python: view.approve_all_url(token)"
                       class="reservation-delete" i18n:translate="">
                       Approve
                    </a>
                </div>

                <div tal:repeat="reservation reservations" class="reservation-list">
                  
                  <metal:block use-macro="context/@@reservations/macros/reservation_data" />
                  <metal:block use-macro="context/@@reservations/macros/reservation_timespans" />
                  
                  <div style="clear: both;"></div>
                </div>
            </div>
            <div class="reservation-quota" tal:condition="python: view.reservation_quota(token) > 1" tal:attributes="data-reservation-quota python: view.reservation_quota(token)">
              <tal:block content="structure python: view.reservation_quota_text(token)"></tal:block>
            </div>
          </tal:block>
        </tal:block>
    </div>
  </div>
<div style="clear: both;"></div>
</div>
</tal:main-macro>
</metal:main>
</body>
</html>
