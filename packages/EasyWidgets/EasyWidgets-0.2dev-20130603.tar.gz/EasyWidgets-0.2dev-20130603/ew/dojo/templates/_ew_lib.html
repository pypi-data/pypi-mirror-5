<div py:strip="True">

  <py:def function="subfields(hidden_fields, fields, error_class, show_labels=True)">
    <py:for each="field in hidden_fields"
            py:with="ctx=widget.context_for(field)">
      ${field.display(**ctx)}
    </py:for>
    <py:for each="field in fields"
            py:with="ctx=widget.context_for(field)">
      <py:if test="show_labels and field.show_label"><label for="$ctx.name">$field.label</label><br/></py:if>
      <py:if test="ctx.errors and field.show_errors"><span class="$error_class">$ctx.errors</span><br/></py:if>
      ${field.display(**ctx)}<br/>
    </py:for>
  </py:def>


  <py:def function="table(field, repetitions, attrs=None)">
    <table py:attrs="attrs">
      <thead>
        <tr><th py:for="col in field.fields"><py:if test="col.show_label">$col.label</py:if></th></tr>
      </thead>
      <tbody>
        <py:for each="i in xrange(repetitions)"
                py:with="ctx=widget.context_for(i)">
          ${field.display(**ctx)}
        </py:for>
      </tbody>
    </table>
  </py:def>


</div>
