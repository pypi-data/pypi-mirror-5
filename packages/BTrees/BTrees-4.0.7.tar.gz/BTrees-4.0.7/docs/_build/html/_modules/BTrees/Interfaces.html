

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>BTrees.Interfaces &mdash; BTrees 4.0.2dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '4.0.2dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="BTrees 4.0.2dev documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">BTrees 4.0.2dev documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for BTrees.Interfaces</h1><div class="highlight"><pre>
<span class="c">##############################################################################</span>
<span class="c">#</span>
<span class="c"># Copyright (c) 2001, 2002 Zope Foundation and Contributors.</span>
<span class="c"># All Rights Reserved.</span>
<span class="c">#</span>
<span class="c"># This software is subject to the provisions of the Zope Public License,</span>
<span class="c"># Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.</span>
<span class="c"># THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY AND ALL EXPRESS OR IMPLIED</span>
<span class="c"># WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<span class="c"># WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS</span>
<span class="c"># FOR A PARTICULAR PURPOSE</span>
<span class="c">#</span>
<span class="c">##############################################################################</span>

<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span><span class="p">,</span> <span class="n">Attribute</span>


<div class="viewcode-block" id="ICollection"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ICollection">[docs]</a><span class="k">class</span> <span class="nc">ICollection</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

<div class="viewcode-block" id="ICollection.clear"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ICollection.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Remove all of the items from the collection.&quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="ICollection.__nonzero__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ICollection.__nonzero__">[docs]</a>    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Check if the collection is non-empty.</span>

<span class="sd">        Return a true value if the collection is non-empty and a</span>
<span class="sd">        false value otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="IReadSequence"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IReadSequence">[docs]</a><span class="k">class</span> <span class="nc">IReadSequence</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

<div class="viewcode-block" id="IReadSequence.__getitem__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IReadSequence.__getitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the value at the given index.</span>

<span class="sd">        An IndexError is raised if the index cannot be found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IReadSequence.__getslice__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IReadSequence.__getslice__">[docs]</a>    <span class="k">def</span> <span class="nf">__getslice__</span><span class="p">(</span><span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a subsequence from the original sequence.</span>

<span class="sd">        The subsequence includes the items from index1 up to, but not</span>
<span class="sd">        including, index2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div></div>
<div class="viewcode-block" id="IKeyed"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeyed">[docs]</a><span class="k">class</span> <span class="nc">IKeyed</span><span class="p">(</span><span class="n">ICollection</span><span class="p">):</span>

<div class="viewcode-block" id="IKeyed.has_key"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeyed.has_key">[docs]</a>    <span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check whether the object has an item with the given key.</span>

<span class="sd">        Return a true value if the key is present, else a false value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IKeyed.keys"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeyed.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludemin</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">excludemax</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an IReadSequence containing the keys in the collection.</span>

<span class="sd">        The type of the IReadSequence is not specified.  It could be a list</span>
<span class="sd">        or a tuple or some other type.</span>

<span class="sd">        All arguments are optional, and may be specified as keyword</span>
<span class="sd">        arguments, or by position.</span>

<span class="sd">        If a min is specified, then output is constrained to keys greater</span>
<span class="sd">        than or equal to the given min, and, if excludemin is specified and</span>
<span class="sd">        true, is further constrained to keys strictly greater than min.  A</span>
<span class="sd">        min value of None is ignored.  If min is None or not specified, and</span>
<span class="sd">        excludemin is true, the smallest key is excluded.</span>

<span class="sd">        If a max is specified, then output is constrained to keys less than</span>
<span class="sd">        or equal to the given max, and, if excludemax is specified and</span>
<span class="sd">        true, is further constrained to keys strictly less than max.  A max</span>
<span class="sd">        value of None is ignored.  If max is None or not specified, and</span>
<span class="sd">        excludemax is true, the largest key is excluded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IKeyed.maxKey"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeyed.maxKey">[docs]</a>    <span class="k">def</span> <span class="nf">maxKey</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the maximum key.</span>

<span class="sd">        If a key argument if provided and not None, return the largest key</span>
<span class="sd">        that is less than or equal to the argument.  Raise an exception if</span>
<span class="sd">        no such key exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IKeyed.minKey"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeyed.minKey">[docs]</a>    <span class="k">def</span> <span class="nf">minKey</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the minimum key.</span>

<span class="sd">        If a key argument if provided and not None, return the smallest key</span>
<span class="sd">        that is greater than or equal to the argument.  Raise an exception</span>
<span class="sd">        if no such key exists.</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="ISetMutable"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISetMutable">[docs]</a><span class="k">class</span> <span class="nc">ISetMutable</span><span class="p">(</span><span class="n">IKeyed</span><span class="p">):</span>

<div class="viewcode-block" id="ISetMutable.insert"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISetMutable.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the key (value) to the set.</span>

<span class="sd">        If the key was already in the set, return 0, otherwise return 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="ISetMutable.remove"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISetMutable.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the key from the set.</span>

<span class="sd">        Raises KeyError if key is not in the set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="ISetMutable.update"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISetMutable.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the items from the given sequence to the set.&quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="ISized"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISized">[docs]</a><span class="k">class</span> <span class="nc">ISized</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An object that supports __len__.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="ISized.__len__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISized.__len__">[docs]</a>    <span class="k">def</span> <span class="nf">__len__</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Return the number of items in the container.&quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="IKeySequence"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeySequence">[docs]</a><span class="k">class</span> <span class="nc">IKeySequence</span><span class="p">(</span><span class="n">IKeyed</span><span class="p">,</span> <span class="n">ISized</span><span class="p">):</span>

<div class="viewcode-block" id="IKeySequence.__getitem__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IKeySequence.__getitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the key in the given index position.</span>

<span class="sd">        This allows iteration with for loops and use in functions,</span>
<span class="sd">        like map and list, that read sequences.</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="ISet"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ISet">[docs]</a><span class="k">class</span> <span class="nc">ISet</span><span class="p">(</span><span class="n">IKeySequence</span><span class="p">,</span> <span class="n">ISetMutable</span><span class="p">):</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="ITreeSet"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.ITreeSet">[docs]</a><span class="k">class</span> <span class="nc">ITreeSet</span><span class="p">(</span><span class="n">IKeyed</span><span class="p">,</span> <span class="n">ISetMutable</span><span class="p">):</span>
    <span class="k">pass</span>
</div>
<div class="viewcode-block" id="IMinimalDictionary"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary">[docs]</a><span class="k">class</span> <span class="nc">IMinimalDictionary</span><span class="p">(</span><span class="n">ISized</span><span class="p">,</span> <span class="n">IKeyed</span><span class="p">):</span>

<div class="viewcode-block" id="IMinimalDictionary.get"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value associated with the given key.</span>

<span class="sd">        Return the default if has_key(key) is false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMinimalDictionary.__getitem__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary.__getitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value associated with the given key.</span>

<span class="sd">        Raise KeyError if has_key(key) is false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMinimalDictionary.__setitem__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary.__setitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value associated with the given key.&quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMinimalDictionary.__delitem__"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary.__delitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete the value associated with the given key.</span>

<span class="sd">        Raise KeyError if has_key(key) is false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMinimalDictionary.values"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludemin</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">excludemax</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an IReadSequence containing the values in the collection.</span>

<span class="sd">        The type of the IReadSequence is not specified.  It could be a list</span>
<span class="sd">        or a tuple or some other type.</span>

<span class="sd">        All arguments are optional, and may be specified as keyword</span>
<span class="sd">        arguments, or by position.</span>

<span class="sd">        If a min is specified, then output is constrained to values whose</span>
<span class="sd">        keys are greater than or equal to the given min, and, if excludemin</span>
<span class="sd">        is specified and true, is further constrained to values whose keys</span>
<span class="sd">        are strictly greater than min.  A min value of None is ignored.  If</span>
<span class="sd">        min is None or not specified, and excludemin is true, the value</span>
<span class="sd">        corresponding to the smallest key is excluded.</span>

<span class="sd">        If a max is specified, then output is constrained to values whose</span>
<span class="sd">        keys are less than or equal to the given max, and, if excludemax is</span>
<span class="sd">        specified and true, is further constrained to values whose keys are</span>
<span class="sd">        strictly less than max.  A max value of None is ignored.  If max is</span>
<span class="sd">        None or not specified, and excludemax is true, the value</span>
<span class="sd">        corresponding to the largest key is excluded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMinimalDictionary.items"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMinimalDictionary.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludemin</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">excludemax</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an IReadSequence containing the items in the collection.</span>

<span class="sd">        An item is a 2-tuple, a (key, value) pair.</span>

<span class="sd">        The type of the IReadSequence is not specified.  It could be a list</span>
<span class="sd">        or a tuple or some other type.</span>

<span class="sd">        All arguments are optional, and may be specified as keyword</span>
<span class="sd">        arguments, or by position.</span>

<span class="sd">        If a min is specified, then output is constrained to items whose</span>
<span class="sd">        keys are greater than or equal to the given min, and, if excludemin</span>
<span class="sd">        is specified and true, is further constrained to items whose keys</span>
<span class="sd">        are strictly greater than min.  A min value of None is ignored.  If</span>
<span class="sd">        min is None or not specified, and excludemin is true, the item with</span>
<span class="sd">        the smallest key is excluded.</span>

<span class="sd">        If a max is specified, then output is constrained to items whose</span>
<span class="sd">        keys are less than or equal to the given max, and, if excludemax is</span>
<span class="sd">        specified and true, is further constrained to items whose keys are</span>
<span class="sd">        strictly less than max.  A max value of None is ignored.  If max is</span>
<span class="sd">        None or not specified, and excludemax is true, the item with the</span>
<span class="sd">        largest key is excluded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div></div>
<div class="viewcode-block" id="IDictionaryIsh"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IDictionaryIsh">[docs]</a><span class="k">class</span> <span class="nc">IDictionaryIsh</span><span class="p">(</span><span class="n">IMinimalDictionary</span><span class="p">):</span>

<div class="viewcode-block" id="IDictionaryIsh.update"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IDictionaryIsh.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the items from the given collection object to the collection.</span>

<span class="sd">        The input collection must be a sequence of (key, value) 2-tuples,</span>
<span class="sd">        or an object with an &#39;items&#39; method that returns a sequence of</span>
<span class="sd">        (key, value) pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IDictionaryIsh.byValue"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IDictionaryIsh.byValue">[docs]</a>    <span class="k">def</span> <span class="nf">byValue</span><span class="p">(</span><span class="n">minValue</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a sequence of (value, key) pairs, sorted by value.</span>

<span class="sd">        Values &lt; minValue are omitted and other values are &quot;normalized&quot; by</span>
<span class="sd">        the minimum value.  This normalization may be a noop, but, for</span>
<span class="sd">        integer values, the normalization is division.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IDictionaryIsh.setdefault"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IDictionaryIsh.setdefault">[docs]</a>    <span class="k">def</span> <span class="nf">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;D.setdefault(k, d) -&gt; D.get(k, d), also set D[k]=d if k not in D.</span>

<span class="sd">        Return the value like get() except that if key is missing, d is both</span>
<span class="sd">        returned and inserted into the dictionary as the value of k.</span>

<span class="sd">        Note that, unlike as for Python&#39;s dict.setdefault(), d is not</span>
<span class="sd">        optional.  Python defaults d to None, but that doesn&#39;t make sense</span>
<span class="sd">        for mappings that can&#39;t have None as a value (for example, an</span>
<span class="sd">        IIBTree can have only integers as values).</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IDictionaryIsh.pop"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IDictionaryIsh.pop">[docs]</a>    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;D.pop(k[, d]) -&gt; v, remove key and return the corresponding value.</span>

<span class="sd">        If key is not found, d is returned if given, otherwise KeyError is</span>
<span class="sd">        raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="IBTree"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IBTree">[docs]</a><span class="k">class</span> <span class="nc">IBTree</span><span class="p">(</span><span class="n">IDictionaryIsh</span><span class="p">):</span>

<div class="viewcode-block" id="IBTree.insert"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IBTree.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a key and value into the collection.</span>

<span class="sd">        If the key was already in the collection, then there is no</span>
<span class="sd">        change and 0 is returned.</span>

<span class="sd">        If the key was not already in the collection, then the item is</span>
<span class="sd">        added and 1 is returned.</span>

<span class="sd">        This method is here to allow one to generate random keys and</span>
<span class="sd">        to insert and test whether the key was there in one operation.</span>

<span class="sd">        A standard idiom for generating new keys will be::</span>

<span class="sd">          key = generate_key()</span>
<span class="sd">          while not t.insert(key, value):</span>
<span class="sd">              key=generate_key()</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="IMerge"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMerge">[docs]</a><span class="k">class</span> <span class="nc">IMerge</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Object with methods for merging sets, buckets, and trees.</span>

<span class="sd">    These methods are supplied in modules that define collection</span>
<span class="sd">    classes with particular key and value types. The operations apply</span>
<span class="sd">    only to collections from the same module.  For example, the</span>
<span class="sd">    IIBTree.union can only be used with IIBTree.IIBTree,</span>
<span class="sd">    IIBTree.IIBucket, IIBTree.IISet, and IIBTree.IITreeSet.</span>

<span class="sd">    The implementing module has a value type. The IOBTree and OOBTree</span>
<span class="sd">    modules have object value type. The IIBTree and OIBTree modules</span>
<span class="sd">    have integer value types. Other modules may be defined in the</span>
<span class="sd">    future that have other value types.</span>

<span class="sd">    The individual types are classified into set (Set and TreeSet) and</span>
<span class="sd">    mapping (Bucket and BTree) types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="IMerge.difference"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMerge.difference">[docs]</a>    <span class="k">def</span> <span class="nf">difference</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the keys or items in c1 for which there is no key in c2.</span>

<span class="sd">        If c1 is None, then None is returned.  If c2 is None, then c1</span>
<span class="sd">        is returned.</span>

<span class="sd">        If neither c1 nor c2 is None, the output is a Set if c1 is a Set or</span>
<span class="sd">        TreeSet, and is a Bucket if c1 is a Bucket or BTree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMerge.union"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMerge.union">[docs]</a>    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the Union of c1 and c2.</span>

<span class="sd">        If c1 is None, then c2 is returned, otherwise, if c2 is None,</span>
<span class="sd">        then c1 is returned.</span>

<span class="sd">        The output is a Set containing keys from the input</span>
<span class="sd">        collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IMerge.intersection"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMerge.intersection">[docs]</a>    <span class="k">def</span> <span class="nf">intersection</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the intersection of c1 and c2.</span>

<span class="sd">        If c1 is None, then c2 is returned, otherwise, if c2 is None,</span>
<span class="sd">        then c1 is returned.</span>

<span class="sd">        The output is a Set containing matching keys from the input</span>
<span class="sd">        collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="IBTreeModule"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IBTreeModule">[docs]</a><span class="k">class</span> <span class="nc">IBTreeModule</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;These are available in all modules (IOBTree, OIBTree, OOBTree, IIBTree,</span>
<span class="sd">    IFBTree, LFBTree, LOBTree, OLBTree, and LLBTree).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">BTree</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;The IBTree for this module.</span>

<span class="sd">        Also available as [prefix]BTree, as in IOBTree.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">Bucket</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;The leaf-node data buckets used by the BTree.</span>

<span class="sd">        (IBucket is not currently defined in this file, but is essentially</span>
<span class="sd">        IDictionaryIsh, with the exception of __nonzero__, as of this</span>
<span class="sd">        writing.)</span>

<span class="sd">        Also available as [prefix]Bucket, as in IOBucket.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">TreeSet</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;The ITreeSet for this module.</span>

<span class="sd">        Also available as [prefix]TreeSet, as in IOTreeSet.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">Set</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;The ISet for this module: the leaf-node data buckets used by the</span>
<span class="sd">        TreeSet.</span>

<span class="sd">        Also available as [prefix]BTree, as in IOSet.&quot;&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IIMerge"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IIMerge">[docs]</a><span class="k">class</span> <span class="nc">IIMerge</span><span class="p">(</span><span class="n">IMerge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Merge collections with integer value type.</span>

<span class="sd">    A primary intent is to support operations with no or integer</span>
<span class="sd">    values, which are used as &quot;scores&quot; to rate indiviual keys. That</span>
<span class="sd">    is, in this context, a BTree or Bucket is viewed as a set with</span>
<span class="sd">    scored keys, using integer scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="IIMerge.weightedUnion"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IIMerge.weightedUnion">[docs]</a>    <span class="k">def</span> <span class="nf">weightedUnion</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">weight1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight2</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the weighted union of c1 and c2.</span>

<span class="sd">        If c1 and c2 are None, the output is (0, None).</span>

<span class="sd">        If c1 is None and c2 is not None, the output is (weight2, c2).</span>

<span class="sd">        If c1 is not None and c2 is None, the output is (weight1, c1).</span>

<span class="sd">        Else, and hereafter, c1 is not None and c2 is not None.</span>

<span class="sd">        If c1 and c2 are both sets, the output is 1 and the (unweighted)</span>
<span class="sd">        union of the sets.</span>

<span class="sd">        Else the output is 1 and a Bucket whose keys are the union of c1 and</span>
<span class="sd">        c2&#39;s keys, and whose values are::</span>

<span class="sd">          v1*weight1 + v2*weight2</span>

<span class="sd">          where:</span>

<span class="sd">            v1 is 0        if the key is not in c1</span>
<span class="sd">                  1        if the key is in c1 and c1 is a set</span>
<span class="sd">                  c1[key]  if the key is in c1 and c1 is a mapping</span>

<span class="sd">            v2 is 0        if the key is not in c2</span>
<span class="sd">                  1        if the key is in c2 and c2 is a set</span>
<span class="sd">                  c2[key]  if the key is in c2 and c2 is a mapping</span>

<span class="sd">        Note that c1 and c2 must be collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="IIMerge.weightedIntersection"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IIMerge.weightedIntersection">[docs]</a>    <span class="k">def</span> <span class="nf">weightedIntersection</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">weight1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight2</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the weighted intersection of c1 and c2.</span>

<span class="sd">        If c1 and c2 are None, the output is (0, None).</span>

<span class="sd">        If c1 is None and c2 is not None, the output is (weight2, c2).</span>

<span class="sd">        If c1 is not None and c2 is None, the output is (weight1, c1).</span>

<span class="sd">        Else, and hereafter, c1 is not None and c2 is not None.</span>

<span class="sd">        If c1 and c2 are both sets, the output is the sum of the weights</span>
<span class="sd">        and the (unweighted) intersection of the sets.</span>

<span class="sd">        Else the output is 1 and a Bucket whose keys are the intersection of</span>
<span class="sd">        c1 and c2&#39;s keys, and whose values are::</span>

<span class="sd">          v1*weight1 + v2*weight2</span>

<span class="sd">          where:</span>

<span class="sd">            v1 is 1        if c1 is a set</span>
<span class="sd">                  c1[key]  if c1 is a mapping</span>

<span class="sd">            v2 is 1        if c2 is a set</span>
<span class="sd">                  c2[key]  if c2 is a mapping</span>

<span class="sd">        Note that c1 and c2 must be collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>

</div></div>
<div class="viewcode-block" id="IMergeIntegerKey"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMergeIntegerKey">[docs]</a><span class="k">class</span> <span class="nc">IMergeIntegerKey</span><span class="p">(</span><span class="n">IMerge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;IMerge-able objects with integer keys.</span>

<span class="sd">    Concretely, this means the types in IOBTree and IIBTree.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="IMergeIntegerKey.multiunion"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IMergeIntegerKey.multiunion">[docs]</a>    <span class="k">def</span> <span class="nf">multiunion</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return union of (zero or more) integer sets, as an integer set.</span>

<span class="sd">        seq is a sequence of objects each convertible to an integer set.</span>
<span class="sd">        These objects are convertible to an integer set:</span>

<span class="sd">        + An integer, which is added to the union.</span>

<span class="sd">        + A Set or TreeSet from the same module (for example, an</span>
<span class="sd">          IIBTree.TreeSet for IIBTree.multiunion()).  The elements of the</span>
<span class="sd">          set are added to the union.</span>

<span class="sd">        + A Bucket or BTree from the same module (for example, an</span>
<span class="sd">          IOBTree.IOBTree for IOBTree.multiunion()).  The keys of the</span>
<span class="sd">          mapping are added to the union.</span>

<span class="sd">        The union is returned as a Set from the same module (for example,</span>
<span class="sd">        IIBTree.multiunion() returns an IIBTree.IISet).</span>

<span class="sd">        The point to this method is that it can run much faster than</span>
<span class="sd">        doing a sequence of two-input union() calls.  Under the covers,</span>
<span class="sd">        all the integers in all the inputs are sorted via a single</span>
<span class="sd">        linear-time radix sort, then duplicates are removed in a second</span>
<span class="sd">        linear-time pass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div></div>
<div class="viewcode-block" id="IBTreeFamily"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IBTreeFamily">[docs]</a><span class="k">class</span> <span class="nc">IBTreeFamily</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;the 64-bit or 32-bit family&quot;&quot;&quot;</span>
    <span class="n">IO</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IIntegerObjectBTreeModule for this family&#39;</span><span class="p">)</span>
    <span class="n">OI</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IObjectIntegerBTreeModule for this family&#39;</span><span class="p">)</span>
    <span class="n">II</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IIntegerIntegerBTreeModule for this family&#39;</span><span class="p">)</span>
    <span class="n">IF</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IIntegerFloatBTreeModule for this family&#39;</span><span class="p">)</span>
    <span class="n">OO</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IObjectObjectBTreeModule for this family&#39;</span><span class="p">)</span>
    <span class="n">maxint</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The maximum integer storable in this family&#39;</span><span class="p">)</span>
    <span class="n">minint</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The minimum integer storable in this family&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IIntegerObjectBTreeModule"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IIntegerObjectBTreeModule">[docs]</a><span class="k">class</span> <span class="nc">IIntegerObjectBTreeModule</span><span class="p">(</span><span class="n">IBTreeModule</span><span class="p">,</span> <span class="n">IMerge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;keys, or set values, are integers; values are objects.</span>

<span class="sd">    describes IOBTree and LOBTree&quot;&quot;&quot;</span>

    <span class="n">family</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IBTreeFamily of this module&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IObjectIntegerBTreeModule"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IObjectIntegerBTreeModule">[docs]</a><span class="k">class</span> <span class="nc">IObjectIntegerBTreeModule</span><span class="p">(</span><span class="n">IBTreeModule</span><span class="p">,</span> <span class="n">IIMerge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;keys, or set values, are objects; values are integers.</span>

<span class="sd">    Object keys (and set values) must sort reliably (for instance, *not* on</span>
<span class="sd">    object id)!  Homogenous key types recommended.</span>

<span class="sd">    describes OIBTree and LOBTree&quot;&quot;&quot;</span>

    <span class="n">family</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IBTreeFamily of this module&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IIntegerIntegerBTreeModule"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IIntegerIntegerBTreeModule">[docs]</a><span class="k">class</span> <span class="nc">IIntegerIntegerBTreeModule</span><span class="p">(</span><span class="n">IBTreeModule</span><span class="p">,</span> <span class="n">IIMerge</span><span class="p">,</span> <span class="n">IMergeIntegerKey</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;keys, or set values, are integers; values are also integers.</span>

<span class="sd">    describes IIBTree and LLBTree&quot;&quot;&quot;</span>

    <span class="n">family</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IBTreeFamily of this module&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IObjectObjectBTreeModule"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IObjectObjectBTreeModule">[docs]</a><span class="k">class</span> <span class="nc">IObjectObjectBTreeModule</span><span class="p">(</span><span class="n">IBTreeModule</span><span class="p">,</span> <span class="n">IMerge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;keys, or set values, are objects; values are also objects.</span>

<span class="sd">    Object keys (and set values) must sort reliably (for instance, *not* on</span>
<span class="sd">    object id)!  Homogenous key types recommended.</span>

<span class="sd">    describes OOBTree&quot;&quot;&quot;</span>

    <span class="c"># Note that there&#39;s no ``family`` attribute; all families include</span>
    <span class="c"># the OO flavor of BTrees.</span>

</div>
<div class="viewcode-block" id="IIntegerFloatBTreeModule"><a class="viewcode-back" href="../../api.html#BTrees.Interfaces.IIntegerFloatBTreeModule">[docs]</a><span class="k">class</span> <span class="nc">IIntegerFloatBTreeModule</span><span class="p">(</span><span class="n">IBTreeModule</span><span class="p">,</span> <span class="n">IMerge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;keys, or set values, are integers; values are floats.</span>

<span class="sd">    describes IFBTree and LFBTree&quot;&quot;&quot;</span>

    <span class="n">family</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&#39;The IBTreeFamily of this module&#39;</span><span class="p">)</span>

</div>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">ZODB.POSException</span> <span class="kn">import</span> <span class="n">BTreesConflictError</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">class</span> <span class="nc">BTreesConflictError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">reason</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c">###############################################################</span>
<span class="c"># IMPORTANT NOTE</span>
<span class="c">#</span>
<span class="c"># Getting the length of a BTree, TreeSet, or output of keys,</span>
<span class="c"># values, or items of same is expensive. If you need to get the</span>
<span class="c"># length, you need to maintain this separately.</span>
<span class="c">#</span>
<span class="c"># Eventually, I need to express this through the interfaces.</span>
<span class="c">#</span>
<span class="c">################################################################</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">BTrees 4.0.2dev documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Zope Foundation Contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>