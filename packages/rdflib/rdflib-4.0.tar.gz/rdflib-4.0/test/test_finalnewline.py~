def testFinalNewline():
    """
    http://code.google.com/p/rdflib/issues/detail?id=5
    """
    import sys
    import platform
    if getattr(sys, 'pypy_version_info', None) or platform.system() == 'Java':
        from nose import SkipTest
        raise SkipTest(
            'Testing under pypy and Jython2.5 fails to detect that ' + \
            'IOMemory is a context_aware store')

    failed = set()
    for p in rdflib.plugin.plugins(None, rdflib.plugin.Serializer):
        if p.name not in ( 'nquads', 'trix' ):
            v = self.graph.serialize(format=p.name)
            lines = v.split(b("\n"))
            if b("\n") not in v or (lines[-1]!=b('')):
                failed.add(p.name)
    self.assertEqual(len(failed), 0, "No final newline for formats: '%s'" % failed)
