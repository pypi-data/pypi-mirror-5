/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.5.0
 * 
 */
var priorityScrollingActive=false;
(function(a){jQuery.fn.extend({slimScroll:function(b){var c={wheelStep:20,width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0.4,alwaysVisible:false,railVisible:false,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:false,scroll:0};
var d=ops=a.extend(c,b);this.each(function(){var H,B,J,e,j,z,C="<div></div>",M=30,r=false,k=parseInt(d.wheelStep),g=d.width,q=d.height,n=d.size,D=d.color,F=d.position,u=d.distance,A=d.start,K=d.opacity,p=d.alwaysVisible,y=d.railVisible,w=d.railColor,N=d.railOpacity,h=d.allowPageScroll,I=d.scroll;
var s=a(this);if(s.parent().hasClass(d.wrapperClass)){if(I){G=s.parent().find("."+d.barClas);m=s.parent().find("."+d.railClass);t(s.scrollTop()+parseInt(I),false,true);
}return;}var v=a(C).addClass(d.wrapperClass).css({overflow:"hidden",width:g,});var l=parseInt(s.css("top"),10);if(0<l){v.css({position:"absolute",top:s.css("top"),bottom:s.css("bottom")});
}else{v.css({position:"relative",height:q});}s.css({overflow:"hidden",width:g,height:q,top:"0px"});var m=a(C).addClass(d.railClass).css({width:n,height:"100%",position:"absolute",top:0,display:(p&&y)?"block":"none","border-radius":n,background:w,opacity:N,zIndex:90});
var G=a(C).addClass(d.barClass).css({background:D,width:n,position:"absolute",top:0,opacity:K,display:p?"block":"none","border-radius":n,BorderRadius:n,MozBorderRadius:n,WebkitBorderRadius:n,zIndex:99});
var i=(F=="right")?{right:u}:{left:u};m.css(i);G.css(i);s.wrap(v);s.parent().append(G);s.parent().append(m);G.draggable({axis:"y",containment:"parent",start:function(){J=true;
},stop:function(){J=false;f();},drag:function(O){t(0,a(this).position().top,false);}});m.hover(function(){L();},function(){f();});G.hover(function(){B=true;
},function(){B=false;});s.hover(function(){if("slimScrollPriority"==s.attr("class")){priorityScrollingActive=true;}H=true;L();f();},function(){H=false;
f();});var E=function(O){if(!H){return;}if(priorityScrollingActive&&"slimScrollPriority"!=s.attr("class")){return;}var O=O||window.event;var P=0;if(O.wheelDelta){P=-O.wheelDelta/120;
}if(O.detail){P=O.detail/3;}t(P,true);if(O.preventDefault&&!r){O.preventDefault();}if(!r){O.returnValue=false;}};function t(T,Q,O){var S=T;if(Q){S=parseInt(G.css("top"))+T*k/100*G.outerHeight();
var R=s.outerHeight()-G.outerHeight();S=Math.min(Math.max(S,0),R);G.css({top:S+"px"});}z=parseInt(G.css("top"))/(s.outerHeight()-G.outerHeight());S=z*(s[0].scrollHeight-s.outerHeight());
if(O){S=T;var P=S/s[0].scrollHeight*s.outerHeight();G.css({top:P+"px"});}s.scrollTop(S);L();f();}var x=function(){if(window.addEventListener){this.addEventListener("DOMMouseScroll",E,false);
this.addEventListener("mousewheel",E,false);}else{document.attachEvent("onmousewheel",E);}};x();function o(){j=Math.max((s.outerHeight()/s[0].scrollHeight)*s.outerHeight(),M);
G.css({height:j+"px"});}o();function L(){o();clearTimeout(e);if("slimScrollPriority"==s.attr("class")){priorityScrollingActive=true;}r=h&&z==~~z;if(j>=s.outerHeight()){r=true;
return;}G.stop(true,true).fadeIn("fast");if(y){m.stop(true,true).fadeIn("fast");}}function f(){if(!p){e=setTimeout(function(){if(!B&&!J){G.fadeOut("slow");
m.fadeOut("slow");if("slimScrollPriority"==s.attr("class")){priorityScrollingActive=false;}}},1000);}}if(A=="bottom"){G.css({top:s.outerHeight()-G.outerHeight()});
t(0,true);}else{if(typeof A=="object"){t(a(A).position().top,null,true);if(!p){G.hide();}}}});return this;}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll});
})(jQuery);