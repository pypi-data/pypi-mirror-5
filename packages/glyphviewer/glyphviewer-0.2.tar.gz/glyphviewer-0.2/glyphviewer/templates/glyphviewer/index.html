{% extends "base.html" %}
{% load glyphtable %}
{% block meta_title %}Glyphviewer{% endblock %}
{% block extra_css %}
<style type="text/css">
@font-face {
    font-family: "OurFontOfNote";
    src: url("{{ fontpath }}");
}
.glyphchar {font-family: "OurFontOfNote";}
</style>
{% endblock %}
{% block main %}
<script type="text/javascript">
function checkInput(ob) {
  var invalidChars = /[^0-9]/gi
  if(invalidChars.test(ob.value)) {
            ob.value = ob.value.replace(invalidChars,"");
      }
}
function setIt (textstring) {
    document.getElementById('glyphexample').firstChild.nodeValue  = textstring;
    document.getElementById('glyphexample').style.fontSize =
        document.getElementById('fontsize').value + "px";
}
function resetIt() {
    document.getElementById('glyphexample').firstChild.nodeValue = "Hello world!";
    document.getElementById('glyphexample').style.fontSize="16px";
}
// I've disabled the code for now, but I could put it back later.
function setRemote() {
//document.getElementById('fonturl').disabled=false;
//document.getElementById('fontname').disabled=true;
}
function setLocal() {
//document.getElementById('fonturl').disabled=true;
//document.getElementById('fontname').disabled=false;
}
window.onload=function(){
  document.getElementById("glytrial").wrap='off';
  document.getElementById('glyphexample').style.fontSize="16px";
//  if (radios[0]) { setLocal();} else {setRemote();}
}
</script>

<h1>Glyphviewer</h1>
<p>&nbsp;</p>
<p><strong>Glyphviewer</strong> is a web application that analyses web font files. This app will parse any 
web font file provided as input, and will display its general information (such as name and copyright details) to the user. <strong>Glyphviewer</strong> also provides a testbed where users can enter text, and
have it displayed using the font. Finally, this application can display the characters supported by the font along with 
their Unicode codepoints.</p>
<p>For more information about this application, see the <a href="doc/">documentation</a>.</p> 
<p><em>Note: most modern fonts represents hundreds, if not thousands, of characters. When the 
<strong>Shows characters in fonts</strong> checkbox is checked, the app will try to display <strong>all</strong> of
the them. The result will be a very long page, which may be an issue for users with bandwidth problems.</em></p>
<form id="fontchoice" action="." method="get" class="inline">
<fieldset>
<legend>Choose a font to analyse.</legend>
<div class = "row-fluid">
<div class = "span1"> <!-- Label -->
<label class="inlineinput" for="rlocal">Local</label>
</div>
<div class = "span1"> <!-- Radio Button -->
<input class="inlineinput" type="radio" name="Location" id="rlocal" value="Local"  {% if not is_remote %} checked="checked" {% endif %} onClick="setLocal();" />
</div>
<div class = "span1"> <!-- Second Label -->
<label class="inlineinput" for="fontname">File</label>
</div>
<div class= "span9"> <!-- Control -->
<select class="inlineinput" id="fontname" name="fontname" >
{% for result in reslistdir %}
    <option {% ifequal result chosenitem %}selected{% endifequal %} value="{{ result }}">{{ result }}</option>
{% endfor %}
</select>
</div>
</div> <!-- End row. -->
<div class = "row-fluid">
<div class = "span1"> <!-- Label -->
<label class="inlineinput" for="rremote">Remote</label>
</div>
<div class = "span1"> <!-- Radio Button -->
<input class="inlineinput" type="radio" name="Location" id="rremote" 
value="Remote" {% if is_remote %} checked="checked" {% endif %}
onClick="setRemote();"/>
</div>
<div class = "span1"> <!-- Second Label -->
<label class="inlineinput" for="fonturl">URL</label>
</div>
<div class= "span9"> <!-- Control -->
<input class="inlineinput" type="text" name="fonturl" id="fonturl" value="{% autoescape on %}{{ remoteurl }}{% endautoescape %}"/>
</div>
</div> <!-- End row. -->

<div class = "row-fluid">
<div class="span3">
<label class="inlineinput" for="shtables">Shows characters in font</label>
</div>
<div class="span1">
<input class="inlineinput" type="checkbox" {% ifequal shtables True %}checked="checked"{% endifequal %}
 name="shtables" id="shtables" value="shtables" />
</div>
<div class="span5">
<label class="inlineinput" for="blocks">Arrange characters as Unicode blocks</label>
</div>
<div class="span1">
<input class="inlineinput" type="checkbox" {% ifequal blocks True %}checked="checked"{% endifequal %}
 name="blocks" id="blocks" value="blocks" />
</div>
<div class= "span2">
<input class="inlineinput button" type="submit" value="Submit" />
</div>
</div>           
</fieldset>
</form>

{% if ourerror == 0 %}

<h2>General information</h2>
<p>This shows information for the font file <strong>{{ displayfont }}</strong> derived from its header.</p>
{% showheader ourheader %}
<p style="text-align: right;"><a href="#top">Return to the top</a></p>
<h2>Testbed</h2>
<p>Here is a sample message. Below it lies a text area where you can enter your test text.
Adjust the font size, and click "Try it" to change the message. Hit "Reset" to return all settings to 
their defaults.</p>
<pre class="glyphchar success" id ="glyphexample">Hello world!</pre>
<form id="textentry" action="." method="post">
    <fieldset>
    <legend>Enter some text to try out the font.</legend>
    <p>
        <textarea name="glytrial" id="glytrial" rows="20" cols="120">Hello world!</textarea>
    </p>
    <div class = "row-fluid">
    <div class ="span3">
    <label class="inlineinput" for="fontsize">Font size (in pixels)</label>
    </div>
    <div class="span5">
    <input class="inlineinput" style="width:100px;" type="text" name="fontsize" id="fontsize" value="16" onkeyup="checkInput(this)"/>
    </div>
    <div class="span2">
        <input type="button" value="Try it" onClick="setIt(glytrial.value);">
    </div>
    
    <div class="span2">
        <input type="reset" value="Reset" onClick="resetIt();"/>
    </div>
    </div>
    </fieldset>
</form>

<p style="text-align: right;"><a href="#top">Return to the top</a></p>
{% if shtables %}
<h2>Supported characters</h2>
<p>The following shows the characters in the font using its glyphs. Unicode
code points are displayed underneath each character.</p>

{% for ourglyph in ourglyphs %}
    {{ ourglyph|glyphtable:8 }}
{% endfor %} 
<p style="text-align: right;"><a href="#top">Return to the top</a></p>
{% endif %}
{% else %}
<div class="error">
<h2>Error</h2>
<p>Glyphviewer was unable to deal with the resource {{ displayfont }}. {{ ermsg }}</p>
</div>
{% endif %}
{% endblock %}