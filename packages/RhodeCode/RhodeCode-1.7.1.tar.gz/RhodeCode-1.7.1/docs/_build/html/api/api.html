
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API &mdash; RhodeCode 1.7.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="RhodeCode 1.7.1 documentation" href="../index.html" />
    <link rel="next" title="The models Module" href="models.html" />
    <link rel="prev" title="Changelog" href="../changelog.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="The models Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../changelog.html" title="Changelog"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">RhodeCode 1.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="api">
<span id="id1"></span><h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<p>Starting from RhodeCode version 1.2 a simple API was implemented.
There&#8217;s a single schema for calling all api methods. API is implemented
with JSON protocol both ways. An url to send API request to RhodeCode is
&lt;your_server&gt;/_admin/api</p>
<div class="section" id="api-access-for-web-views">
<h2>API ACCESS FOR WEB VIEWS<a class="headerlink" href="#api-access-for-web-views" title="Permalink to this headline">¶</a></h2>
<p>API access can also be turned on for each web view in RhodeCode that is
decorated with <cite>&#64;LoginRequired</cite> decorator. To enable API access simple change
the standard login decorator to <cite>&#64;LoginRequired(api_access=True)</cite>.</p>
<p>To make this operation easier, starting from version 1.7.0 there&#8217;s a white list
of views that will have API access enabled. Simply edit <cite>api_access_controllers_whitelist</cite>
option in your .ini file, and define views that should have API access enabled.
Following example shows how to enable API access to patch/diff raw file and archive
in RhodeCode:</p>
<div class="highlight-python"><pre>api_access_controllers_whitelist =
    ChangesetController:changeset_patch,
    ChangesetController:changeset_raw,
    FilesController:raw,
    FilesController:archivefile</pre>
</div>
<p>After this change, a rhodecode view can be accessed without login by adding a
GET parameter <cite>?api_key=&lt;api_key&gt;</cite> to url. By default this is only
enabled on RSS/ATOM feed views. Exposing raw diffs is a good way to integrate with
3rd party services like code review, or build farms that could download archives.</p>
</div>
<div class="section" id="api-access">
<h2>API ACCESS<a class="headerlink" href="#api-access" title="Permalink to this headline">¶</a></h2>
<p>All clients are required to send JSON-RPC spec JSON data:</p>
<div class="highlight-python"><pre>{
    "id:"&lt;id&gt;",
    "api_key":"&lt;api_key&gt;",
    "method":"&lt;method_name&gt;",
    "args":{"&lt;arg_key&gt;":"&lt;arg_val&gt;"}
}</pre>
</div>
<dl class="docutils">
<dt>Example call for autopulling remotes repos using curl::</dt>
<dd>curl <a class="reference external" href="https://server.com/_admin/api">https://server.com/_admin/api</a> -X POST -H &#8216;content-type:text/plain&#8217; &#8211;data-binary &#8216;{&#8220;id&#8221;:1,&#8221;api_key&#8221;:&#8221;xe7cdb2v278e4evbdf5vs04v832v0efvcbcve4a3&#8221;,&#8221;method&#8221;:&#8221;pull&#8221;,&#8221;args&#8221;:{&#8220;repo&#8221;:&#8221;CPython&#8221;}}&#8217;</dd>
<dt>Simply provide</dt>
<dd><ul class="first last simple">
<li><em>id</em> A value of any type, which is used to match the response with the request that it is replying to.</li>
<li><em>api_key</em> for access and permission validation.</li>
<li><em>method</em> is name of method to call</li>
<li><em>args</em> is an key:value list of arguments to pass to method</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">api_key can be found in your user account page</p>
</div>
<p>RhodeCode API will return always a JSON-RPC response:</p>
<div class="highlight-python"><pre>{
    "id":&lt;id&gt;, # matching id sent by request
    "result": "&lt;result&gt;"|null, # JSON formatted result, null if any errors
    "error": "null"|&lt;error_message&gt; # JSON formatted error (if any)
}</pre>
</div>
<p>All responses from API will be <cite>HTTP/1.0 200 OK</cite>, if there&#8217;s an error while
calling api <em>error</em> key from response will contain failure description
and result will be null.</p>
</div>
<div class="section" id="api-client">
<h2>API CLIENT<a class="headerlink" href="#api-client" title="Permalink to this headline">¶</a></h2>
<p>From version 1.4 RhodeCode adds a script that allows to easily
communicate with API. After installing RhodeCode a <cite>rhodecode-api</cite> script
will be available.</p>
<p>To get started quickly simply run:</p>
<div class="highlight-python"><pre>rhodecode-api _create_config --apikey=&lt;youapikey&gt; --apihost=&lt;rhodecode host&gt;</pre>
</div>
<p>This will create a file named .config in the directory you executed it storing
json config file with credentials. You can skip this step and always provide
both of the arguments to be able to communicate with server</p>
<p>after that simply run any api command for example get_repo:</p>
<div class="highlight-python"><pre>rhodecode-api get_repo

calling {"api_key": "&lt;apikey&gt;", "id": 75, "args": {}, "method": "get_repo"} to http://127.0.0.1:5000
rhodecode said:
{'error': 'Missing non optional `repoid` arg in JSON DATA',
 'id': 75,
 'result': None}</pre>
</div>
<p>Ups looks like we forgot to add an argument</p>
<p>Let&#8217;s try again now giving the repoid as parameters:</p>
<div class="highlight-python"><pre>rhodecode-api get_repo repoid:rhodecode

calling {"api_key": "&lt;apikey&gt;", "id": 39, "args": {"repoid": "rhodecode"}, "method": "get_repo"} to http://127.0.0.1:5000
rhodecode said:
{'error': None,
 'id': 39,
 'result': &lt;json data...&gt;}</pre>
</div>
</div>
<div class="section" id="api-methods">
<h2>API METHODS<a class="headerlink" href="#api-methods" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pull">
<h3>pull<a class="headerlink" href="#pull" title="Permalink to this headline">¶</a></h3>
<p>Pulls given repo from remote location. Can be used to automatically keep
remote repos up to date. This command can be executed only using api_key
belonging to user with admin rights</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "pull"
args :    {
            "repoid" : "&lt;reponame or repo_id&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : "Pulled from `&lt;reponame&gt;`"
error :  null</pre>
</div>
</div>
<div class="section" id="rescan-repos">
<h3>rescan_repos<a class="headerlink" href="#rescan-repos" title="Permalink to this headline">¶</a></h3>
<p>Dispatch rescan repositories action. If remove_obsolete is set
RhodeCode will delete repos that are in database but not in the filesystem.
This command can be executed only using api_key belonging to user with admin
rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "rescan_repos"
args :    {
            "remove_obsolete" : "&lt;boolean = Optional(False)&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : "{'added': [&lt;list of names of added repos&gt;],
           'removed': [&lt;list of names of removed repos&gt;]}"
error :  null</pre>
</div>
</div>
<div class="section" id="invalidate-cache">
<h3>invalidate_cache<a class="headerlink" href="#invalidate-cache" title="Permalink to this headline">¶</a></h3>
<p>Invalidate cache for repository.
This command can be executed only using api_key belonging to user with admin
rights or regular user that have write or admin or write access to repository.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "invalidate_cache"
args :    {
            "repoid" : "&lt;reponame or repo_id&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : "Caches of repository `&lt;reponame&gt;`"
error :  null</pre>
</div>
</div>
<div class="section" id="lock">
<h3>lock<a class="headerlink" href="#lock" title="Permalink to this headline">¶</a></h3>
<p>Set locking state on given repository by given user. If userid param is skipped
, then it is set to id of user whos calling this method. If locked param is skipped
then function shows current lock state of given repo.
This command can be executed only using api_key belonging to user with admin
rights or regular user that have admin or write access to repository.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "lock"
args :    {
            "repoid" : "&lt;reponame or repo_id&gt;"
            "userid" : "&lt;user_id or username = Optional(=apiuser)&gt;",
            "locked" : "&lt;bool true|false = Optional(=None)&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : {
             "repo": "&lt;reponame&gt;",
             "locked": "&lt;bool true|false&gt;",
             "locked_since": "&lt;float lock_time&gt;",
             "locked_by": "&lt;username&gt;",
             "msg": "User `&lt;username&gt;` set lock state for repo `&lt;reponame&gt;` to `&lt;false|true&gt;`"
         }
error :  null</pre>
</div>
</div>
<div class="section" id="show-ip">
<h3>show_ip<a class="headerlink" href="#show-ip" title="Permalink to this headline">¶</a></h3>
<p>Shows IP address as seen from RhodeCode server, together with all
defined IP addresses for given user.
This command can be executed only using api_key belonging to user with admin
rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "show_ip"
args :    {
            "userid" : "&lt;user_id or username&gt;",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : {
             "ip_addr_server": &lt;ip_from_clien&gt;",
             "user_ips": [
                            {
                               "ip_addr": "&lt;ip_with_mask&gt;",
                               "ip_range": ["&lt;start_ip&gt;", "&lt;end_ip&gt;"],
                            },
                            ...
                         ]
         }

error :  null</pre>
</div>
</div>
<div class="section" id="get-user">
<h3>get_user<a class="headerlink" href="#get-user" title="Permalink to this headline">¶</a></h3>
<p>Get&#8217;s an user by username or user_id, Returns empty result if user is not found.
If userid param is skipped it is set to id of user who is calling this method.
This command can be executed only using api_key belonging to user with admin
rights, or regular users that cannot specify different userid than theirs</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_user"
args :    {
            "userid" : "&lt;username or user_id Optional(=apiuser)&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: None if user does not exist or
        {
            "user_id" :     "&lt;user_id&gt;",
            "api_key" :     "&lt;api_key&gt;",
            "username" :    "&lt;username&gt;",
            "firstname":    "&lt;firstname&gt;",
            "lastname" :    "&lt;lastname&gt;",
            "email" :       "&lt;email&gt;",
            "emails":       "&lt;list_of_all_additional_emails&gt;",
            "ip_addresses": "&lt;list_of_ip_addresses_for_user&gt;",
            "active" :      "&lt;bool&gt;",
            "admin" :       "&lt;bool&gt;",
            "ldap_dn" :     "&lt;ldap_dn&gt;",
            "last_login":   "&lt;last_login&gt;",
            "permissions": {
                "global": ["hg.create.repository",
                           "repository.read",
                           "hg.register.manual_activate"],
                "repositories": {"repo1": "repository.none"},
                "repositories_groups": {"Group1": "group.read"}
             },
        }

error:  null</pre>
</div>
</div>
<div class="section" id="get-users">
<h3>get_users<a class="headerlink" href="#get-users" title="Permalink to this headline">¶</a></h3>
<p>Lists all existing users. This command can be executed only using api_key
belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_users"
args :    { }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: [
          {
            "user_id" :     "&lt;user_id&gt;",
            "api_key" :     "&lt;api_key&gt;",
            "username" :    "&lt;username&gt;",
            "firstname":    "&lt;firstname&gt;",
            "lastname" :    "&lt;lastname&gt;",
            "email" :       "&lt;email&gt;",
            "emails":       "&lt;list_of_all_additional_emails&gt;",
            "ip_addresses": "&lt;list_of_ip_addresses_for_user&gt;",
            "active" :      "&lt;bool&gt;",
            "admin" :       "&lt;bool&gt;",
            "ldap_dn" :     "&lt;ldap_dn&gt;",
            "last_login":   "&lt;last_login&gt;",
          },
          …
        ]
error:  null</pre>
</div>
</div>
<div class="section" id="create-user">
<h3>create_user<a class="headerlink" href="#create-user" title="Permalink to this headline">¶</a></h3>
<p>Creates new user. This command can
be executed only using api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "create_user"
args :    {
            "username" :  "&lt;username&gt;",
            "email" :     "&lt;useremail&gt;",
            "password" :  "&lt;password = Optional(None)&gt;",
            "firstname" : "&lt;firstname&gt; = Optional(None)",
            "lastname" :  "&lt;lastname&gt; = Optional(None)",
            "active" :    "&lt;bool&gt; = Optional(True)",
            "admin" :     "&lt;bool&gt; = Optional(False)",
            "ldap_dn" :   "&lt;ldap_dn&gt; = Optional(None)"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "created new user `&lt;username&gt;`",
          "user": {
            "user_id" :  "&lt;user_id&gt;",
            "username" : "&lt;username&gt;",
            "firstname": "&lt;firstname&gt;",
            "lastname" : "&lt;lastname&gt;",
            "email" :    "&lt;email&gt;",
            "emails":    "&lt;list_of_all_additional_emails&gt;",
            "active" :   "&lt;bool&gt;",
            "admin" :    "&lt;bool&gt;",
            "ldap_dn" :  "&lt;ldap_dn&gt;",
            "last_login": "&lt;last_login&gt;",
          },
        }
error:  null</pre>
</div>
</div>
<div class="section" id="update-user">
<h3>update_user<a class="headerlink" href="#update-user" title="Permalink to this headline">¶</a></h3>
<p>updates given user if such user exists. This command can
be executed only using api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "update_user"
args :    {
            "userid" : "&lt;user_id or username&gt;",
            "username" :  "&lt;username&gt; = Optional(None)",
            "email" :     "&lt;useremail&gt; = Optional(None)",
            "password" :  "&lt;password&gt; = Optional(None)",
            "firstname" : "&lt;firstname&gt; = Optional(None)",
            "lastname" :  "&lt;lastname&gt; = Optional(None)",
            "active" :    "&lt;bool&gt; = Optional(None)",
            "admin" :     "&lt;bool&gt; = Optional(None)",
            "ldap_dn" :   "&lt;ldap_dn&gt; = Optional(None)"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "updated user ID:&lt;userid&gt; &lt;username&gt;",
          "user": {
            "user_id" :  "&lt;user_id&gt;",
            "api_key" :  "&lt;api_key&gt;",
            "username" : "&lt;username&gt;",
            "firstname": "&lt;firstname&gt;",
            "lastname" : "&lt;lastname&gt;",
            "email" :    "&lt;email&gt;",
            "emails":    "&lt;list_of_all_additional_emails&gt;",
            "active" :   "&lt;bool&gt;",
            "admin" :    "&lt;bool&gt;",
            "ldap_dn" :  "&lt;ldap_dn&gt;",
            "last_login": "&lt;last_login&gt;",
          },
        }
error:  null</pre>
</div>
</div>
<div class="section" id="delete-user">
<h3>delete_user<a class="headerlink" href="#delete-user" title="Permalink to this headline">¶</a></h3>
<p>deletes givenuser if such user exists. This command can
be executed only using api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "delete_user"
args :    {
            "userid" : "&lt;user_id or username&gt;",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "deleted user ID:&lt;userid&gt; &lt;username&gt;",
          "user": null
        }
error:  null</pre>
</div>
</div>
<div class="section" id="get-users-group">
<h3>get_users_group<a class="headerlink" href="#get-users-group" title="Permalink to this headline">¶</a></h3>
<p>Gets an existing user group. This command can be executed only using api_key
belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_users_group"
args :    {
            "usersgroupid" : "&lt;user group id or name&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : None if group not exist
         {
           "users_group_id" : "&lt;id&gt;",
           "group_name" :     "&lt;groupname&gt;",
           "active":          "&lt;bool&gt;",
           "members" :  [
                          {
                            "user_id" :  "&lt;user_id&gt;",
                            "api_key" :  "&lt;api_key&gt;",
                            "username" : "&lt;username&gt;",
                            "firstname": "&lt;firstname&gt;",
                            "lastname" : "&lt;lastname&gt;",
                            "email" :    "&lt;email&gt;",
                            "emails":    "&lt;list_of_all_additional_emails&gt;",
                            "active" :   "&lt;bool&gt;",
                            "admin" :    "&lt;bool&gt;",
                            "ldap_dn" :  "&lt;ldap_dn&gt;",
                            "last_login": "&lt;last_login&gt;",
                          },
                          …
                        ]
         }
error : null</pre>
</div>
</div>
<div class="section" id="get-users-groups">
<h3>get_users_groups<a class="headerlink" href="#get-users-groups" title="Permalink to this headline">¶</a></h3>
<p>Lists all existing user groups. This command can be executed only using
api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_users_groups"
args :    { }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result : [
           {
           "users_group_id" : "&lt;id&gt;",
           "group_name" :     "&lt;groupname&gt;",
           "active":          "&lt;bool&gt;",
           },
           …
          ]
error : null</pre>
</div>
</div>
<div class="section" id="create-users-group">
<h3>create_users_group<a class="headerlink" href="#create-users-group" title="Permalink to this headline">¶</a></h3>
<p>Creates new user group. This command can be executed only using api_key
belonging to user with admin rights</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "create_users_group"
args:     {
            "group_name": "&lt;groupname&gt;",
            "owner" :     "&lt;onwer_name_or_id = Optional(=apiuser)&gt;",
            "active":     "&lt;bool&gt; = Optional(True)"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg": "created new user group `&lt;groupname&gt;`",
          "users_group": {
                 "users_group_id" : "&lt;id&gt;",
                 "group_name" :     "&lt;groupname&gt;",
                 "active":          "&lt;bool&gt;",
           },
        }
error:  null</pre>
</div>
</div>
<div class="section" id="add-user-to-users-group">
<h3>add_user_to_users_group<a class="headerlink" href="#add-user-to-users-group" title="Permalink to this headline">¶</a></h3>
<p>Adds a user to a user group. If user exists in that group success will be
<cite>false</cite>. This command can be executed only using api_key
belonging to user with admin rights</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "add_user_users_group"
args:     {
            "usersgroupid" : "&lt;user group id or name&gt;",
            "userid" : "&lt;user_id or username&gt;",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "success": True|False # depends on if member is in group
          "msg": "added member `&lt;username&gt;` to user group `&lt;groupname&gt;` |
                  User is already in that group"
        }
error:  null</pre>
</div>
</div>
<div class="section" id="remove-user-from-users-group">
<h3>remove_user_from_users_group<a class="headerlink" href="#remove-user-from-users-group" title="Permalink to this headline">¶</a></h3>
<p>Removes a user from a user group. If user is not in given group success will
be <cite>false</cite>. This command can be executed only
using api_key belonging to user with admin rights</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "remove_user_from_users_group"
args:     {
            "usersgroupid" : "&lt;user group id or name&gt;",
            "userid" : "&lt;user_id or username&gt;",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "success":  True|False,  # depends on if member is in group
          "msg": "removed member &lt;username&gt; from user group &lt;groupname&gt; |
                  User wasn't in group"
        }
error:  null</pre>
</div>
</div>
<div class="section" id="get-repo">
<h3>get_repo<a class="headerlink" href="#get-repo" title="Permalink to this headline">¶</a></h3>
<p>Gets an existing repository by it&#8217;s name or repository_id. Members will return
either users_group or user associated to that repository. This command can be
executed only using api_key belonging to user with admin
rights or regular user that have at least read access to repository.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_repo"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: None if repository does not exist or
        {
            "repo_id" :          "&lt;repo_id&gt;",
            "repo_name" :        "&lt;reponame&gt;"
            "repo_type" :        "&lt;repo_type&gt;",
            "clone_uri" :        "&lt;clone_uri&gt;",
            "enable_downloads":  "&lt;bool&gt;",
            "enable_locking":    "&lt;bool&gt;",
            "enable_statistics": "&lt;bool&gt;",
            "private":           "&lt;bool&gt;",
            "created_on" :       "&lt;date_time_created&gt;",
            "description" :      "&lt;description&gt;",
            "landing_rev":       "&lt;landing_rev&gt;",
            "last_changeset":    {
                                   "author":   "&lt;full_author&gt;",
                                   "date":     "&lt;date_time_of_commit&gt;",
                                   "message":  "&lt;commit_message&gt;",
                                   "raw_id":   "&lt;raw_id&gt;",
                                   "revision": "&lt;numeric_revision&gt;",
                                   "short_id": "&lt;short_id&gt;"
                                 }
            "owner":             "&lt;repo_owner&gt;",
            "fork_of":           "&lt;name_of_fork_parent&gt;",
            "members" :     [
                              {
                                "type":        "user",
                                "user_id" :    "&lt;user_id&gt;",
                                "api_key" :    "&lt;api_key&gt;",
                                "username" :   "&lt;username&gt;",
                                "firstname":   "&lt;firstname&gt;",
                                "lastname" :   "&lt;lastname&gt;",
                                "email" :      "&lt;email&gt;",
                                "emails":      "&lt;list_of_all_additional_emails&gt;",
                                "active" :     "&lt;bool&gt;",
                                "admin" :      "&lt;bool&gt;",
                                "ldap_dn" :    "&lt;ldap_dn&gt;",
                                "last_login":  "&lt;last_login&gt;",
                                "permission" : "repository.(read|write|admin)"
                              },
                              …
                              {
                                "type":      "users_group",
                                "id" :       "&lt;usersgroupid&gt;",
                                "name" :     "&lt;usersgroupname&gt;",
                                "active":    "&lt;bool&gt;",
                                "permission" : "repository.(read|write|admin)"
                              },
                              …
                            ]
             "followers":   [
                              {
                                "user_id" :     "&lt;user_id&gt;",
                                "username" :    "&lt;username&gt;",
                                "api_key" :     "&lt;api_key&gt;",
                                "firstname":    "&lt;firstname&gt;",
                                "lastname" :    "&lt;lastname&gt;",
                                "email" :       "&lt;email&gt;",
                                "emails":       "&lt;list_of_all_additional_emails&gt;",
                                "ip_addresses": "&lt;list_of_ip_addresses_for_user&gt;",
                                "active" :      "&lt;bool&gt;",
                                "admin" :       "&lt;bool&gt;",
                                "ldap_dn" :     "&lt;ldap_dn&gt;",
                                "last_login":   "&lt;last_login&gt;",
                              },
                              …
             ]
        }
error:  null</pre>
</div>
</div>
<div class="section" id="get-repos">
<h3>get_repos<a class="headerlink" href="#get-repos" title="Permalink to this headline">¶</a></h3>
<p>Lists all existing repositories. This command can be executed only using
api_key belonging to user with admin rights or regular user that have
admin, write or read access to repository.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_repos"
args:     { }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: [
          {
            "repo_id" :          "&lt;repo_id&gt;",
            "repo_name" :        "&lt;reponame&gt;"
            "repo_type" :        "&lt;repo_type&gt;",
            "clone_uri" :        "&lt;clone_uri&gt;",
            "private": :         "&lt;bool&gt;",
            "created_on" :       "&lt;datetimecreated&gt;",
            "description" :      "&lt;description&gt;",
            "landing_rev":       "&lt;landing_rev&gt;",
            "owner":             "&lt;repo_owner&gt;",
            "fork_of":           "&lt;name_of_fork_parent&gt;",
            "enable_downloads":  "&lt;bool&gt;",
            "enable_locking":    "&lt;bool&gt;",
            "enable_statistics": "&lt;bool&gt;",
          },
          …
        ]
error:  null</pre>
</div>
</div>
<div class="section" id="get-repo-nodes">
<h3>get_repo_nodes<a class="headerlink" href="#get-repo-nodes" title="Permalink to this headline">¶</a></h3>
<p>returns a list of nodes and it&#8217;s children in a flat list for a given path
at given revision. It&#8217;s possible to specify ret_type to show only <cite>files</cite> or
<cite>dirs</cite>. This command can be executed only using api_key belonging to user
with admin rights</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "get_repo_nodes"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;"
            "revision"  : "&lt;revision&gt;",
            "root_path" : "&lt;root_path&gt;",
            "ret_type"  : "&lt;ret_type&gt; = Optional('all')"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: [
          {
            "name" :        "&lt;name&gt;"
            "type" :        "&lt;type&gt;",
          },
          …
        ]
error:  null</pre>
</div>
</div>
<div class="section" id="create-repo">
<h3>create_repo<a class="headerlink" href="#create-repo" title="Permalink to this headline">¶</a></h3>
<p>Creates a repository. If repository name contains &#8220;/&#8221;, all needed repository
groups will be created. For example &#8220;foo/bar/baz&#8221; will create groups
&#8220;foo&#8221;, &#8220;bar&#8221; (with &#8220;foo&#8221; as parent), and create &#8220;baz&#8221; repository with
&#8220;bar&#8221; as group. This command can be executed only using api_key belonging to user with admin
rights or regular user that have create repository permission. Regular users
cannot specify owner parameter</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "create_repo"
args:     {
            "repo_name" :        "&lt;reponame&gt;",
            "owner" :            "&lt;onwer_name_or_id = Optional(=apiuser)&gt;",
            "repo_type" :        "&lt;repo_type&gt; = Optional('hg')",
            "description" :      "&lt;description&gt; = Optional('')",
            "private" :          "&lt;bool&gt; = Optional(False)",
            "clone_uri" :        "&lt;clone_uri&gt; = Optional(None)",
            "landing_rev" :      "&lt;landing_rev&gt; = Optional('tip')",
            "enable_downloads":  "&lt;bool&gt; = Optional(False)",
            "enable_locking":    "&lt;bool&gt; = Optional(False)",
            "enable_statistics": "&lt;bool&gt; = Optional(False)",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg": "Created new repository `&lt;reponame&gt;`",
          "repo": {
            "repo_id" :          "&lt;repo_id&gt;",
            "repo_name" :        "&lt;reponame&gt;"
            "repo_type" :        "&lt;repo_type&gt;",
            "clone_uri" :        "&lt;clone_uri&gt;",
            "private": :         "&lt;bool&gt;",
            "created_on" :       "&lt;datetimecreated&gt;",
            "description" :      "&lt;description&gt;",
            "landing_rev":       "&lt;landing_rev&gt;",
            "owner":             "&lt;username or user_id&gt;",
            "fork_of":           "&lt;name_of_fork_parent&gt;",
            "enable_downloads":  "&lt;bool&gt;",
            "enable_locking":    "&lt;bool&gt;",
            "enable_statistics": "&lt;bool&gt;",
          },
        }
error:  null</pre>
</div>
</div>
<div class="section" id="fork-repo">
<h3>fork_repo<a class="headerlink" href="#fork-repo" title="Permalink to this headline">¶</a></h3>
<p>Creates a fork of given repo. In case of using celery this will
immidiatelly return success message, while fork is going to be created
asynchronous. This command can be executed only using api_key belonging to
user with admin rights or regular user that have fork permission, and at least
read access to forking repository. Regular users cannot specify owner parameter.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "fork_repo"
args:     {
            "repoid" :          "&lt;reponame or repo_id&gt;",
            "fork_name":        "&lt;forkname&gt;",
            "owner":            "&lt;username or user_id = Optional(=apiuser)&gt;",
            "description":      "&lt;description&gt;",
            "copy_permissions": "&lt;bool&gt;",
            "private":          "&lt;bool&gt;",
            "landing_rev":      "&lt;landing_rev&gt;"

          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg": "Created fork of `&lt;reponame&gt;` as `&lt;forkname&gt;`",
          "success": true
        }
error:  null</pre>
</div>
</div>
<div class="section" id="delete-repo">
<h3>delete_repo<a class="headerlink" href="#delete-repo" title="Permalink to this headline">¶</a></h3>
<p>Deletes a repository. This command can be executed only using api_key belonging
to user with admin rights or regular user that have admin access to repository.
When <cite>forks</cite> param is set it&#8217;s possible to detach or delete forks of deleting
repository</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "delete_repo"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;",
            "forks"  : "`delete` or `detach` = Optional(None)"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg": "Deleted repository `&lt;reponame&gt;`",
          "success": true
        }
error:  null</pre>
</div>
</div>
<div class="section" id="grant-user-permission">
<h3>grant_user_permission<a class="headerlink" href="#grant-user-permission" title="Permalink to this headline">¶</a></h3>
<p>Grant permission for user on given repository, or update existing one
if found. This command can be executed only using api_key belonging to user
with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "grant_user_permission"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;"
            "userid" : "&lt;username or user_id&gt;"
            "perm" :       "(repository.(none|read|write|admin))",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "Granted perm: `&lt;perm&gt;` for user: `&lt;username&gt;` in repo: `&lt;reponame&gt;`",
          "success": true
        }
error:  null</pre>
</div>
</div>
<div class="section" id="revoke-user-permission">
<h3>revoke_user_permission<a class="headerlink" href="#revoke-user-permission" title="Permalink to this headline">¶</a></h3>
<p>Revoke permission for user on given repository. This command can be executed
only using api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method  : "revoke_user_permission"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;"
            "userid" : "&lt;username or user_id&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "Revoked perm for user: `&lt;username&gt;` in repo: `&lt;reponame&gt;`",
          "success": true
        }
error:  null</pre>
</div>
</div>
<div class="section" id="grant-users-group-permission">
<h3>grant_users_group_permission<a class="headerlink" href="#grant-users-group-permission" title="Permalink to this headline">¶</a></h3>
<p>Grant permission for user group on given repository, or update
existing one if found. This command can be executed only using
api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method :  "grant_users_group_permission"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;"
            "usersgroupid" : "&lt;user group id or name&gt;"
            "perm" : "(repository.(none|read|write|admin))",
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "Granted perm: `&lt;perm&gt;` for group: `&lt;usersgroupname&gt;` in repo: `&lt;reponame&gt;`",
          "success": true
        }
error:  null</pre>
</div>
</div>
<div class="section" id="revoke-users-group-permission">
<h3>revoke_users_group_permission<a class="headerlink" href="#revoke-users-group-permission" title="Permalink to this headline">¶</a></h3>
<p>Revoke permission for user group on given repository.This command can be
executed only using api_key belonging to user with admin rights.</p>
<p>INPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_for_response&gt;
api_key : "&lt;api_key&gt;"
method  : "revoke_users_group_permission"
args:     {
            "repoid" : "&lt;reponame or repo_id&gt;"
            "usersgroupid" : "&lt;user group id or name&gt;"
          }</pre>
</div>
<p>OUTPUT:</p>
<div class="highlight-python"><pre>id : &lt;id_given_in_input&gt;
result: {
          "msg" : "Revoked perm for group: `&lt;usersgroupname&gt;` in repo: `&lt;reponame&gt;`",
          "success": true
        }
error:  null</pre>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3>Support RhodeCode development.</h3>
<div style="text-align:center">
    <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
        <input type="hidden" name="cmd" value="_s-xclick">
        <input type="hidden" name="hosted_button_id" value="8U2LLRPLBKWDU">
        <input style="border:0px !important" type="image" src="https://www.paypal.com/en_US/i/btn/btn_donate_SM.gif"
        border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
        <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>
    <div style="padding:5px">
     <a href="http://flattr.com/thing/167489/RhodeCode" target="_blank">
     <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a>
    </div>
</div>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API</a><ul>
<li><a class="reference internal" href="#api-access-for-web-views">API ACCESS FOR WEB VIEWS</a></li>
<li><a class="reference internal" href="#api-access">API ACCESS</a></li>
<li><a class="reference internal" href="#api-client">API CLIENT</a></li>
<li><a class="reference internal" href="#api-methods">API METHODS</a><ul>
<li><a class="reference internal" href="#pull">pull</a></li>
<li><a class="reference internal" href="#rescan-repos">rescan_repos</a></li>
<li><a class="reference internal" href="#invalidate-cache">invalidate_cache</a></li>
<li><a class="reference internal" href="#lock">lock</a></li>
<li><a class="reference internal" href="#show-ip">show_ip</a></li>
<li><a class="reference internal" href="#get-user">get_user</a></li>
<li><a class="reference internal" href="#get-users">get_users</a></li>
<li><a class="reference internal" href="#create-user">create_user</a></li>
<li><a class="reference internal" href="#update-user">update_user</a></li>
<li><a class="reference internal" href="#delete-user">delete_user</a></li>
<li><a class="reference internal" href="#get-users-group">get_users_group</a></li>
<li><a class="reference internal" href="#get-users-groups">get_users_groups</a></li>
<li><a class="reference internal" href="#create-users-group">create_users_group</a></li>
<li><a class="reference internal" href="#add-user-to-users-group">add_user_to_users_group</a></li>
<li><a class="reference internal" href="#remove-user-from-users-group">remove_user_from_users_group</a></li>
<li><a class="reference internal" href="#get-repo">get_repo</a></li>
<li><a class="reference internal" href="#get-repos">get_repos</a></li>
<li><a class="reference internal" href="#get-repo-nodes">get_repo_nodes</a></li>
<li><a class="reference internal" href="#create-repo">create_repo</a></li>
<li><a class="reference internal" href="#fork-repo">fork_repo</a></li>
<li><a class="reference internal" href="#delete-repo">delete_repo</a></li>
<li><a class="reference internal" href="#grant-user-permission">grant_user_permission</a></li>
<li><a class="reference internal" href="#revoke-user-permission">revoke_user_permission</a></li>
<li><a class="reference internal" href="#grant-users-group-permission">grant_users_group_permission</a></li>
<li><a class="reference internal" href="#revoke-users-group-permission">revoke_users_group_permission</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../changelog.html"
                        title="previous chapter">Changelog</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="models.html"
                        title="next chapter">The <tt class="docutils literal"><span class="pre">models</span></tt> Module</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="The models Module"
             >next</a> |</li>
        <li class="right" >
          <a href="../changelog.html" title="Changelog"
             >previous</a> |</li>
        <li><a href="../index.html">RhodeCode 1.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Marcin Kuzminski.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>