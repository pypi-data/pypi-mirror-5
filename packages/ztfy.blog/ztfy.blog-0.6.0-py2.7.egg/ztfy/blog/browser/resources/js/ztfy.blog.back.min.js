(function(a){if(typeof(a.ZBlog)=="undefined"){a.ZBlog={}}a.ZBlog.treeview={init:function(b){a("TABLE.treeview TR.section TD.title, TABLE.treeview TR.topic TD.title",b).draggable({helper:"clone",opacity:0.75,revert:"invalid",revertDuration:300,scroll:true,containment:"TABLE.treeview"});a("TABLE.treeview TR.site",b).droppable({accept:"TR.section TD.title",hoverClass:"accept",over:function(c,d){if(this.id!=a(d.draggable.parents("TR")[0]).id&&!a(this).is(".expanded")){a(this).expand()}},drop:a.ZTFY.treeview.changeParent});a("TABLE.treeview TR.section",b).droppable({accept:"TR.section TD.title, TR.topic TD.title",hoverClass:"accept",over:function(c,d){if(this.id!=a(d.draggable.parents("TR")[0]).id&&!a(this).is(".expanded")){a(this).expand()}},drop:a.ZTFY.treeview.changeParent})}};a.ZBlog.reference={activate:function(b){a("INPUT[name="+b+"]").attr("readonly","").val("").focus();a("INPUT[name="+b+"]").prev().val("")},keyPressed:function(b){if(b.which==13){a.ZBlog.reference.search(this);return false}},search:function(d){var b;var c={url:a.ZTFY.ajax.getAddr(),type:"POST",method:"search",async:false,params:{query:d},success:function(f,e){b=f.result},error:function(g,e,f){jAlert(g.responseText,"Error !",window.location.reload)}};a.jsonRpc(c);return b},select:function(b,d){var c=a.ZBlog.reference.source;a(c).prev().val(b);a(c).val(d+" (OID: "+b+")").attr("readonly","readonly");a("#selector").overlay().close();a("#selector").remove();return false}};a.ZBlog.topic={remove:function(b){a.ZTFY.ajax.post(a(b).attr("action")+"/@@ajax/ajaxDelete",{},a.ZBlog.topic.removeCallback,null,"json");return false},removeCallback:function(b,c){if(c=="success"){window.location=b.url}}}})(jQuery);