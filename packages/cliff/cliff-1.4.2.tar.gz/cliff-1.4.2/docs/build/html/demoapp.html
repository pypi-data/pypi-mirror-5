

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Exploring the Demo App &mdash; cliff 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="cliff 1.1 documentation" href="index.html" />
    <link rel="next" title="List Commands" href="list_commands.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="list_commands.html" title="List Commands"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">cliff 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="exploring-the-demo-app">
<h1>Exploring the Demo App<a class="headerlink" href="#exploring-the-demo-app" title="Permalink to this headline">¶</a></h1>
<p>The cliff source package includes a <tt class="docutils literal"><span class="pre">demoapp</span></tt> directory containing
an example main program with several command plugins.</p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>To install and experiment with the demo app you should create a
virtual environment and activate it. This will make it easy to remove
the app later, since it doesn&#8217;t do anything useful and you aren&#8217;t
likely to want to hang onto it after you understand how it works.</p>
<div class="highlight-python"><pre>$ pip install virtualenv
$ virtualenv .venv
$ . .venv/bin/activate
(.venv)$</pre>
</div>
<p>Next, install cliff in the same environment.</p>
<div class="highlight-python"><pre>(.venv)$ python setup.py install</pre>
</div>
<p>Finally, install the demo application into the virtual environment.</p>
<div class="highlight-python"><pre>(.venv)$ cd demoapp
(.venv)$ python setup.py install</pre>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Both cliff and the demo installed, you can now run the command
<tt class="docutils literal"><span class="pre">cliffdemo</span></tt>.</p>
<p>For basic command usage instructions and a list of the commands
available from the plugins, run:</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo -h</pre>
</div>
<p>or:</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo --help</pre>
</div>
<p>Run the <tt class="docutils literal"><span class="pre">simple</span></tt> command by passing its name as argument to <tt class="docutils literal"><span class="pre">cliffdemo</span></tt>.</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo simple</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">simple</span></tt> command prints this output to the console:</p>
<div class="highlight-python"><pre>sending greeting
hi!</pre>
</div>
<p>To see help for an individual command, use the <tt class="docutils literal"><span class="pre">help</span></tt> command:</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo help files</pre>
</div>
</div>
<div class="section" id="the-source">
<h2>The Source<a class="headerlink" href="#the-source" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">cliffdemo</span></tt> application is defined in a <tt class="docutils literal"><span class="pre">cliffdemo</span></tt> package
containing several modules.</p>
<div class="section" id="main-py">
<h3>main.py<a class="headerlink" href="#main-py" title="Permalink to this headline">¶</a></h3>
<p>The main application is defined in <tt class="docutils literal"><span class="pre">main.py</span></tt>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">cliff.app</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">cliff.commandmanager</span> <span class="kn">import</span> <span class="n">CommandManager</span>


<span class="k">class</span> <span class="nc">DemoApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>

    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DemoApp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="s">&#39;cliff demo app&#39;</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="s">&#39;0.1&#39;</span><span class="p">,</span>
            <span class="n">command_manager</span><span class="o">=</span><span class="n">CommandManager</span><span class="p">(</span><span class="s">&#39;cliff.demo&#39;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argv</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;initialize_app&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare_to_run_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;prepare_to_run_command </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">cmd</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clean_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">err</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;clean_up </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">cmd</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;got an error: </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">myapp</span> <span class="o">=</span> <span class="n">DemoApp</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">myapp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>
</td></tr></table></div>
<p>The <tt class="xref py py-class docutils literal"><span class="pre">DemoApp</span></tt> class inherits from <tt class="xref py py-class docutils literal"><span class="pre">App</span></tt> and overrides
<tt class="xref py py-func docutils literal"><span class="pre">__init__()</span></tt> to set the program description and version number. It
also passes a <tt class="xref py py-class docutils literal"><span class="pre">CommandManager</span></tt> instance configured to look for
plugins in the <tt class="docutils literal"><span class="pre">cliff.demo</span></tt> namespace.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">initialize_app()</span></tt> method of <tt class="xref py py-class docutils literal"><span class="pre">DemoApp</span></tt> will be invoked
after the main program arguments are parsed, but before any command
processing is performed and before the application enters interactive
mode. This hook is intended for opening connections to remote web
services, databases, etc. using arguments passed to the main
application.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">prepare_to_run_command()</span></tt> method of <tt class="xref py py-class docutils literal"><span class="pre">DemoApp</span></tt> will be
invoked after a command is identified, but before the command is given
its arguments and run. This hook is intended for pre-command
validation or setup that must be repeated and cannot be handled by
<tt class="xref py py-func docutils literal"><span class="pre">initialize_app()</span></tt>.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">clean_up()</span></tt> method of <tt class="xref py py-class docutils literal"><span class="pre">DemoApp</span></tt> is invoked after a
command runs. If the command raised an exception, the exception object
is passed to <tt class="xref py py-func docutils literal"><span class="pre">clean_up()</span></tt>. Otherwise the <tt class="docutils literal"><span class="pre">err</span></tt> argument is
<tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>The <tt class="xref py py-func docutils literal"><span class="pre">main()</span></tt> function defined in <tt class="docutils literal"><span class="pre">main.py</span></tt> is registered as a
console script entry point so that <tt class="xref py py-class docutils literal"><span class="pre">DemoApp</span></tt> can be run from
the command line (see the discussion of <tt class="docutils literal"><span class="pre">setup.py</span></tt> below).</p>
</div>
<div class="section" id="simple-py">
<h3>simple.py<a class="headerlink" href="#simple-py" title="Permalink to this headline">¶</a></h3>
<p>Two commands are defined in <tt class="docutils literal"><span class="pre">simple.py</span></tt>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">cliff.command</span> <span class="kn">import</span> <span class="n">Command</span>


<span class="k">class</span> <span class="nc">Simple</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="s">&quot;A simple command that prints a message.&quot;</span>

    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;sending greeting&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;debugging&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;hi!</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Error</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="s">&quot;Always raises an error&quot;</span>

    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;causing error&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;this is the expected exception&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><tt class="xref py py-class docutils literal"><span class="pre">Simple</span></tt> demonstrates using logging to emit messages on the
console at different verbose levels.</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo simple
sending greeting
hi!

(.venv)$ cliffdemo -v simple
prepare_to_run_command Simple
sending greeting
debugging
hi!
clean_up Simple

(.venv)$ cliffdemo -q simple
hi!</pre>
</div>
<p><tt class="xref py py-class docutils literal"><span class="pre">Error</span></tt> always raises a <tt class="xref py py-class docutils literal"><span class="pre">RuntimeError</span></tt> exception when it
is invoked, and can be used to experiment with the error handling
features of cliff.</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo error
causing error
ERROR: this is the expected exception

(.venv)$ cliffdemo -v error
prepare_to_run_command Error
causing error
ERROR: this is the expected exception
clean_up Error
got an error: this is the expected exception

(.venv)$ cliffdemo --debug error
causing error
this is the expected exception
Traceback (most recent call last):
  File ".../cliff/app.py", line 218, in run_subcommand
    result = cmd.run(parsed_args)
  File ".../cliff/command.py", line 43, in run
    self.take_action(parsed_args)
  File ".../demoapp/cliffdemo/simple.py", line 24, in take_action
    raise RuntimeError('this is the expected exception')
RuntimeError: this is the expected exception
Traceback (most recent call last):
  File "/Users/dhellmann/Envs/cliff/bin/cliffdemo", line 9, in &lt;module&gt;
    load_entry_point('cliffdemo==0.1', 'console_scripts', 'cliffdemo')()
  File ".../demoapp/cliffdemo/main.py", line 33, in main
    return myapp.run(argv)
  File ".../cliff/app.py", line 160, in run
    result = self.run_subcommand(remainder)
  File ".../cliff/app.py", line 218, in run_subcommand
    result = cmd.run(parsed_args)
  File ".../cliff/command.py", line 43, in run
    self.take_action(parsed_args)
  File ".../demoapp/cliffdemo/simple.py", line 24, in take_action
    raise RuntimeError('this is the expected exception')
RuntimeError: this is the expected exception</pre>
</div>
</div>
<div class="section" id="list-py">
<span id="demoapp-list"></span><h3>list.py<a class="headerlink" href="#list-py" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">list.py</span></tt> includes a single command derived from
<a class="reference internal" href="classes.html#cliff.lister.Lister" title="cliff.lister.Lister"><tt class="xref py py-class docutils literal"><span class="pre">cliff.lister.Lister</span></tt></a> which prints a list of the files in the
current directory.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">cliff.lister</span> <span class="kn">import</span> <span class="n">Lister</span>


<span class="k">class</span> <span class="nc">Files</span><span class="p">(</span><span class="n">Lister</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show a list of files in the current directory.</span>

<span class="sd">    The file name and size are printed by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="s">&#39;Name&#39;</span><span class="p">,</span> <span class="s">&#39;Size&#39;</span><span class="p">),</span>
                <span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">))</span>
                <span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><tt class="xref py py-class docutils literal"><span class="pre">Files</span></tt> prepares the data, and <tt class="xref py py-class docutils literal"><span class="pre">Lister</span></tt> manages the
output formatter and printing the data to the console.</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo files
+---------------+------+
|      Name     | Size |
+---------------+------+
| build         |  136 |
| cliffdemo.log | 2546 |
| Makefile      | 5569 |
| source        |  408 |
+---------------+------+

(.venv)$ cliffdemo files -f csv
"Name","Size"
"build",136
"cliffdemo.log",2690
"Makefile",5569
"source",408</pre>
</div>
</div>
<div class="section" id="show-py">
<span id="demoapp-show"></span><h3>show.py<a class="headerlink" href="#show-py" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">show.py</span></tt> includes a single command derived from
<a class="reference internal" href="classes.html#cliff.show.ShowOne" title="cliff.show.ShowOne"><tt class="xref py py-class docutils literal"><span class="pre">cliff.show.ShowOne</span></tt></a> which prints the properties of the named
file.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">cliff.show</span> <span class="kn">import</span> <span class="n">ShowOne</span>


<span class="k">class</span> <span class="nc">File</span><span class="p">(</span><span class="n">ShowOne</span><span class="p">):</span>
    <span class="s">&quot;Show details about a file&quot;</span>

    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog_name</span><span class="p">):</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">File</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_parser</span><span class="p">(</span><span class="n">prog_name</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&#39;filename&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s">&#39;?&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="nf">take_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="n">stat_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Name&#39;</span><span class="p">,</span>
                   <span class="s">&#39;Size&#39;</span><span class="p">,</span>
                   <span class="s">&#39;UID&#39;</span><span class="p">,</span>
                   <span class="s">&#39;GID&#39;</span><span class="p">,</span>
                   <span class="s">&#39;Modified Time&#39;</span><span class="p">,</span>
                   <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">stat_data</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span>
                <span class="n">stat_data</span><span class="o">.</span><span class="n">st_uid</span><span class="p">,</span>
                <span class="n">stat_data</span><span class="o">.</span><span class="n">st_gid</span><span class="p">,</span>
                <span class="n">stat_data</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><tt class="xref py py-class docutils literal"><span class="pre">File</span></tt> prepares the data, and <tt class="xref py py-class docutils literal"><span class="pre">ShowOne</span></tt> manages the
output formatter and printing the data to the console.</p>
<div class="highlight-python"><pre>(.venv)$ cliffdemo file setup.py
+---------------+--------------+
|     Field     |    Value     |
+---------------+--------------+
| Name          | setup.py     |
| Size          | 5825         |
| UID           | 502          |
| GID           | 20           |
| Modified Time | 1335569964.0 |
+---------------+--------------+</pre>
</div>
</div>
<div class="section" id="setup-py">
<h3>setup.py<a class="headerlink" href="#setup-py" title="Permalink to this headline">¶</a></h3>
<p>The demo application is packaged using <a class="reference external" href="http://packages.python.org/distribute/">distribute</a>, the modern
implementation of setuptools.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="n">PROJECT</span> <span class="o">=</span> <span class="s">&#39;cliffdemo&#39;</span>

<span class="c"># Change docs/sphinx/conf.py too!</span>
<span class="n">VERSION</span> <span class="o">=</span> <span class="s">&#39;0.1&#39;</span>

<span class="c"># Bootstrap installation of Distribute</span>
<span class="kn">import</span> <span class="nn">distribute_setup</span>
<span class="n">distribute_setup</span><span class="o">.</span><span class="n">use_setuptools</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="kn">from</span> <span class="nn">distutils.util</span> <span class="kn">import</span> <span class="n">convert_path</span>
<span class="kn">from</span> <span class="nn">fnmatch</span> <span class="kn">import</span> <span class="n">fnmatchcase</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">long_description</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;README.rst&#39;</span><span class="p">,</span> <span class="s">&#39;rt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="n">long_description</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">PROJECT</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">VERSION</span><span class="p">,</span>

    <span class="n">description</span><span class="o">=</span><span class="s">&#39;Demo app for cliff&#39;</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="n">long_description</span><span class="p">,</span>

    <span class="n">author</span><span class="o">=</span><span class="s">&#39;Doug Hellmann&#39;</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s">&#39;doug.hellmann@gmail.com&#39;</span><span class="p">,</span>

    <span class="n">url</span><span class="o">=</span><span class="s">&#39;https://github.com/dreamhost/cliff&#39;</span><span class="p">,</span>
    <span class="n">download_url</span><span class="o">=</span><span class="s">&#39;https://github.com/dreamhost/cliff/tarball/master&#39;</span><span class="p">,</span>

    <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Development Status :: 3 - Alpha&#39;</span><span class="p">,</span>
                 <span class="s">&#39;License :: OSI Approved :: Apache Software License&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Programming Language :: Python&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Programming Language :: Python :: 2&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Programming Language :: Python :: 2.7&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Programming Language :: Python :: 3&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Programming Language :: Python :: 3.2&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Intended Audience :: Developers&#39;</span><span class="p">,</span>
                 <span class="s">&#39;Environment :: Console&#39;</span><span class="p">,</span>
                 <span class="p">],</span>

    <span class="n">platforms</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;Any&#39;</span><span class="p">],</span>

    <span class="n">scripts</span><span class="o">=</span><span class="p">[],</span>

    <span class="n">provides</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;distribute&#39;</span><span class="p">,</span> <span class="s">&#39;cliff&#39;</span><span class="p">],</span>

    <span class="n">namespace_packages</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
    <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>

    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
        <span class="s">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">&#39;cliffdemo = cliffdemo.main:main&#39;</span>
            <span class="p">],</span>
        <span class="s">&#39;cliff.demo&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">&#39;simple = cliffdemo.simple:Simple&#39;</span><span class="p">,</span>
            <span class="s">&#39;two_part = cliffdemo.simple:Simple&#39;</span><span class="p">,</span>
            <span class="s">&#39;error = cliffdemo.simple:Error&#39;</span><span class="p">,</span>
            <span class="s">&#39;list files = cliffdemo.list:Files&#39;</span><span class="p">,</span>
            <span class="s">&#39;files = cliffdemo.list:Files&#39;</span><span class="p">,</span>
            <span class="s">&#39;file = cliffdemo.show:File&#39;</span><span class="p">,</span>
            <span class="s">&#39;show file = cliffdemo.show:File&#39;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">},</span>

    <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The important parts of the packaging instructions are the
<tt class="docutils literal"><span class="pre">entry_points</span></tt> settings. All of the commands are registered in the
<tt class="docutils literal"><span class="pre">cliff.demo</span></tt> namespace. Each main program should define its own
command namespace so that it only loads the command plugins that it
should be managing.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Exploring the Demo App</a><ul>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#the-source">The Source</a><ul>
<li><a class="reference internal" href="#main-py">main.py</a></li>
<li><a class="reference internal" href="#simple-py">simple.py</a></li>
<li><a class="reference internal" href="#list-py">list.py</a></li>
<li><a class="reference internal" href="#show-py">show.py</a></li>
<li><a class="reference internal" href="#setup-py">setup.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="list_commands.html"
                        title="next chapter">List Commands</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/demoapp.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="list_commands.html" title="List Commands"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="index.html">cliff 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Doug Hellmann.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>