{% extends "layout.html" %}

{% block body %}
    <form method="POST">
        <table>
            <tr>
                <th>Hostname</th>
                <th>IP</th>
                <th>Port</th>
                <th>Uptime</th>
                <th>PID</th>
                <th>PPID</th>
                <th>Queue</th>
                <th>Consuming</th>
                <th>Current Task</th>
                <th>Actions</th>
            </tr>
            {% for addr, master in sockets|dictsort(by='value') %}
            <tr>
                <td>{{ master.stats.hostname }}</td>
                <td>{{ addr[0] }}</td>
                <td>{{ addr[1] }}</td>
                <td>{{ human_time(master.stats.uptime) }}</td>
                <td>{{ master.stats.pid }}</td>
                <td>{{ master.stats.ppid }}</td>
                <td>{{ master.stats.queue.name }}</td>
                <td>{{ master.stats.consuming }}</td>
                <td>{{ master.stats.current_task }}</td>
                <td>
                    {{ action_button(addr, 'warm_shutdown', 'Warm Shutdown') }}
                    {{ action_button(addr, 'cold_shutdown', 'Cold Shutdown') }}
                </td>
            </tr>
            {% endfor %}
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    {{ action_button_all('worker', 'warm_shutdown', 'Warm Shutdown All') }}
                    {{ action_button_all('worker', 'cold_shutdown', 'Cold Shutdown All') }}
                </td>
            </tr>
        </table>
        Count: {{ sockets|count }}
    </form>
{% endblock %}
